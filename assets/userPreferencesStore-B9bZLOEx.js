import{m as c,p as f,h as n,u as i,j as l}from"./firebase-DCzW8K6T.js";import{j as d}from"./index-CrqZLxMN.js";import"./vendor-77yDWcJJ.js";import"./router-YYQTkf18.js";const m=e=>e==="IT"||e==="EN"||e==="JA"||e==="RU",p=e=>e==="female"||e==="male",a=e=>c(d(),"users",e,"settings","app"),D=async e=>{try{const t=await f(a(e));if(!t.exists())return null;const r=t.data(),o={};return m(r.locale)&&(o.locale=r.locale),typeof r.confirmDelete=="boolean"&&(o.confirmDelete=r.confirmDelete),typeof r.showHoverInfo=="boolean"&&(o.showHoverInfo=r.showHoverInfo),Array.isArray(r.categories)&&(o.categories=r.categories.filter(s=>typeof s=="string")),p(r.profileGender)&&(o.profileGender=r.profileGender),o}catch(t){throw console.warn("[firestore] loadUserPreferences failed",t),t}},P=async(e,t)=>{try{const r=a(e),o={...t,updatedAt:n()};try{await i(r,o);return}catch(s){if(s.code!=="not-found")throw s}await l(r,{...o,createdAt:n()},{merge:!0})}catch(r){throw console.warn("[firestore] saveUserPreferences failed",r),r}},A=e=>{if(typeof window>"u")return!1;try{return[`ws-confirm-delete-${e}`,`ws-hover-info-${e}`,`ws-categories-${e}`,`ws-profile-gender-${e}`,"ws-lang"].some(r=>localStorage.getItem(r)!==null)}catch{return!1}};export{a as getUserPreferencesDocRef,A as hasAnyLocalPreferences,D as loadUserPreferences,P as saveUserPreferences};
