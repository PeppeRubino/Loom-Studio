import{r as o,j as t,a0 as Le}from"./vendor-77yDWcJJ.js";import{B as O}from"./Button-CI2oUu3j.js";import{C as Be}from"./Card-B3nxRyRw.js";import{a as ie,u as dt,d as Te,e as Ae,b as mt,l as ut,f as ft,c as pt,s as gt}from"./index-CrqZLxMN.js";import{C as Oe,E as xt,T as ht,R as bt,b as wt,c as yt,S as vt,P as jt,I as De,d as Nt,e as Ct}from"./icons-DL2PgYE_.js";import{A as St,m as kt}from"./motion-KXh7TDlr.js";import{I as G}from"./Input-Bi6IGvP7.js";import{u as Rt,U as It}from"./useCategorySettings-DCQ8-ADA.js";import{f as Et,a as Lt,c as Me,r as Tt,u as Pe}from"./fallback_m-DD1dC9O4.js";import{upsertUserProfileFromAuth as At,loadWardrobeFromFirestore as Dt,migrateLocalToFirestoreIfNeeded as Mt,saveWardrobeToFirestore as _e}from"./wardrobeStore-eMnyq0wL.js";import"./firebase-DCzW8K6T.js";import"./router-YYQTkf18.js";const le=({label:n,options:r,value:l,onChange:u,open:g,onOpenChange:N})=>{const{t:d}=ie(),[m,k]=o.useState(!1),R=typeof g=="boolean",b=R?g:m,w=o.useMemo(()=>a=>{if(R){const y=typeof a=="function"?a(g):a;N?.(y);return}k(j=>{const y=typeof a=="function"?a(j):a;return N?.(y),y})},[R,N,g]),x=o.useRef(null),T=o.useRef(null),C=o.useRef(null),[I,A]=o.useState(null),E=l?r.find(a=>a.value===l)?.label??l:void 0,i=r.length;o.useEffect(()=>{if(!b)return;const a=y=>{const S=y.target;S&&x.current&&(x.current.contains(S)||w(!1))},j=y=>{y.key==="Escape"&&w(!1)};return document.addEventListener("mousedown",a),document.addEventListener("touchstart",a),document.addEventListener("keydown",j),()=>{document.removeEventListener("mousedown",a),document.removeEventListener("touchstart",a),document.removeEventListener("keydown",j)}},[b,w]),o.useEffect(()=>{if(!b)return;const a=()=>{const y=x.current,S=T.current,D=C.current;if(!y||!S||!D)return;const F=y.getBoundingClientRect(),_=S.getBoundingClientRect(),M=D.offsetWidth||176,U=8,z=window.innerWidth;let H=_.left+_.width/2-M/2;H=Math.max(U,Math.min(H,z-M-U)),A(H-F.left)},j=window.requestAnimationFrame(a);return window.addEventListener("resize",a),()=>{window.cancelAnimationFrame(j),window.removeEventListener("resize",a)}},[n,b,i,E]);const v=o.useMemo(()=>I==null?void 0:{left:I,right:"auto"},[I]);return t.jsxs("div",{ref:x,className:"relative",children:[t.jsxs("button",{ref:T,type:"button",className:Le("flex items-center gap-2 rounded-full border border-[rgba(0,0,0,0.04)] bg-white/55 px-3.5 py-[5px] text-sm text-[#0f172a] shadow-[0_8px_20px_-20px_rgba(15,23,42,0.3)] transition duration-[120ms]",b&&"ring-2 ring-[#c1124d]/20"),onClick:()=>w(a=>!a),children:[t.jsx("span",{children:E||n}),t.jsx(Oe,{size:14,className:"text-[#94a3b8]"})]}),t.jsx(St,{children:b&&t.jsxs(kt.div,{ref:C,initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.12},className:"absolute z-20 mt-2 w-44 rounded-2xl border border-[#e2e8f0] bg-white p-2 shadow-[0_16px_40px_-28px_rgba(15,23,42,0.55)]",style:v,children:[t.jsx("button",{className:"w-full rounded-xl px-3 py-2 text-left text-sm text-[#475569] hover:bg-[#f8fafc]",onClick:()=>{u(void 0),w(!1)},children:d("common.all","Tutti")}),r.map(a=>t.jsx("button",{className:Le("w-full rounded-xl px-3 py-2 text-left text-sm text-[#0f172a] hover:bg-[#f8fafc]",l===a.value&&"bg-[#f1f5f9] font-semibold"),onClick:()=>{u(a.value),w(!1)},children:a.label},a.value))]})})]})},Pt={accent:"border border-transparent text-[#b11226]",neutral:"border border-[rgba(0,0,0,0.08)] text-[#0f172a]",muted:"border border-[rgba(0,0,0,0.06)] text-[#475569]"},J=({children:n,tone:r="neutral"})=>{const l=r??"neutral";return t.jsx("span",{className:`user-select-none inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-[11px] font-medium antialiased shadow-[0_6px_14px_-10px_rgba(15,23,42,0.14)] transition-shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#0f172a]/20 sm:text-[12px] ${Pt[l]}`,children:n})},_t=n=>n.trim().toLowerCase().replace(/\s+/g," ").replace(/[’']/g,"'"),zt={primavera:"term.season.spring",spring:"term.season.spring",春:"term.season.spring",весна:"term.season.spring",estate:"term.season.summer",summer:"term.season.summer",夏:"term.season.summer",лето:"term.season.summer",autunno:"term.season.autumn",autumn:"term.season.autumn",fall:"term.season.autumn",秋:"term.season.autumn",осень:"term.season.autumn",inverno:"term.season.winter",winter:"term.season.winter",冬:"term.season.winter",зима:"term.season.winter",maglietta:"term.category.tshirt",tshirt:"term.category.tshirt","t-shirt":"term.category.tshirt","t shirt":"term.category.tshirt",футболка:"term.category.tshirt",tシャツ:"term.category.tshirt",camicia:"term.category.shirt",shirt:"term.category.shirt",рубашка:"term.category.shirt",シャツ:"term.category.shirt",pantaloni:"term.category.pants",pants:"term.category.pants",trousers:"term.category.pants",брюки:"term.category.pants",パンツ:"term.category.pants",scarpe:"term.category.shoes",shoes:"term.category.shoes",обувь:"term.category.shoes",靴:"term.category.shoes",giacca:"term.category.jacket",jacket:"term.category.jacket",куртка:"term.category.jacket",ジャケット:"term.category.jacket",cappotto:"term.category.coat",coat:"term.category.coat",пальто:"term.category.coat",コート:"term.category.coat",felpa:"term.category.hoodie",hoodie:"term.category.hoodie",sweatshirt:"term.category.hoodie",худи:"term.category.hoodie",パーカー:"term.category.hoodie",vestito:"term.category.dress",dress:"term.category.dress",платье:"term.category.dress",ワンピース:"term.category.dress",gonna:"term.category.skirt",skirt:"term.category.skirt",юбка:"term.category.skirt",スカート:"term.category.skirt",accessori:"term.category.accessories",accessories:"term.category.accessories",аксессуары:"term.category.accessories",アクセサリー:"term.category.accessories",nero:"term.color.black",black:"term.color.black",黒:"term.color.black",чёрный:"term.color.black",черный:"term.color.black",bianco:"term.color.white",white:"term.color.white",白:"term.color.white",белый:"term.color.white",grigio:"term.color.gray",grey:"term.color.gray",gray:"term.color.gray",灰:"term.color.gray",серый:"term.color.gray",blu:"term.color.blue",blue:"term.color.blue",青:"term.color.blue",синий:"term.color.blue",rosso:"term.color.red",red:"term.color.red",赤:"term.color.red",красный:"term.color.red",verde:"term.color.green",green:"term.color.green",緑:"term.color.green",зелёный:"term.color.green",зеленый:"term.color.green",giallo:"term.color.yellow",yellow:"term.color.yellow",黄:"term.color.yellow",жёлтый:"term.color.yellow",желтый:"term.color.yellow",rosa:"term.color.pink",pink:"term.color.pink",ピンク:"term.color.pink",розовый:"term.color.pink",viola:"term.color.purple",purple:"term.color.purple",紫:"term.color.purple",фиолетовый:"term.color.purple",marrone:"term.color.brown",brown:"term.color.brown",茶:"term.color.brown",коричневый:"term.color.brown",beige:"term.color.beige",ベージュ:"term.color.beige",бежевый:"term.color.beige",arancione:"term.color.orange",orange:"term.color.orange",オレンジ:"term.color.orange",оранжевый:"term.color.orange"},de=(n,r)=>{const l=zt[_t(n)];return l?r(l,n):n},Fe=(n,r)=>de(n,r),ce=(n,r)=>de(n,r),Ue=(n,r)=>de(n,r),Bt=({item:n,onSelectTerm:r,onDelete:l,onEdit:u,onReplacePhoto:g,showHoverInfo:N=!0,fallbackImage:d=""})=>{const{t:m}=ie(),[k,R]=o.useState(!1),[b,w]=o.useState(!1),x=a=>{a&&r?.(a)},T=[...n.tags].sort((a,j)=>a.localeCompare(j,"it",{sensitivity:"base"})),C=n.image?.url||d,I=!!(l||u||g),A=ce(n.name||n.category,m),E=ce(n.category,m),i=Ue(n.color,m),v=Fe(n.season,m);return t.jsx("div",{className:"transition-shadow duration-[120ms]",children:t.jsxs(Be,{className:"p-3",children:[t.jsxs("div",{className:"group relative aspect-square overflow-hidden rounded-[14px] bg-[#f8fafc] p-3 flex items-center justify-center",children:[t.jsx("img",{src:C,alt:n.name,className:"max-h-[60%] w-full object-contain",loading:"lazy",onError:a=>{d&&(a.target.src=d)}}),N&&t.jsx("div",{className:"pointer-events-none absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/55 via-black/20 to-transparent p-3 text-white opacity-0 transition-opacity duration-[120ms] group-hover:opacity-100",children:n.note?t.jsx("p",{className:"text-[12px] text-white/90 line-clamp-3 sm:text-[13px]",children:n.note}):t.jsx("p",{className:"text-[12px] text-white/70 sm:text-[13px]",children:m("garment.noNote","Nessuna nota")})})]}),t.jsxs("div",{className:"mt-3 flex items-start justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-base font-semibold text-[#0f172a] leading-tight",children:A}),t.jsxs("p",{className:"text-sm text-[#64748b]",children:[i," · ",v]})]}),I&&t.jsxs("div",{className:"relative",children:[t.jsx("button",{type:"button",className:"rounded-full bg-white/70 p-2 text-[#94a3b8] shadow-sm hover:text-[#0f172a]","aria-label":m("garment.menu","Menu"),onClick:()=>w(a=>!a),children:t.jsx(xt,{size:14})}),b&&t.jsxs("div",{className:"absolute right-0 z-20 mt-2 w-44 rounded-2xl border border-[rgba(0,0,0,0.08)] bg-white p-2 shadow-lg",children:[t.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#0f172a] hover:bg-[#f7f7f8]",onClick:()=>{w(!1),l?.(n.id)},children:[t.jsx(ht,{size:14})," ",m("garment.remove","Rimuovi")]}),t.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#475569] hover:bg-[#f7f7f8]",onClick:()=>{w(!1),u?.(n)},disabled:!u,children:[t.jsx(bt,{size:14})," ",m("garment.edit","Modifica")]}),t.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#475569] hover:bg-[#f7f7f8]",onClick:()=>{w(!1),g?.(n)},disabled:!g,children:[t.jsx(wt,{size:14})," ",m("garment.replacePhoto","Sostituisci foto")]})]})]})]}),t.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[t.jsx("button",{type:"button",onClick:()=>x(n.category),className:"focus:outline-none",children:t.jsx(J,{tone:"neutral",children:E})}),t.jsx("button",{type:"button",onClick:()=>x(n.color),className:"focus:outline-none",children:t.jsx(J,{tone:"neutral",children:i})}),t.jsx("button",{type:"button",onClick:()=>x(n.season),className:"focus:outline-none",children:t.jsx(J,{tone:"neutral",children:v})})]}),n.tags.length>0&&t.jsxs("div",{className:"mt-2",children:[t.jsxs("button",{type:"button",onClick:()=>R(a=>!a),className:"flex items-center gap-2 text-[12px] font-semibold uppercase tracking-[0.2em] text-[#475569] hover:text-[#0f172a] sm:text-[13px]",children:[k?t.jsx(yt,{size:14}):t.jsx(Oe,{size:14}),m("garment.tags","Tag")]}),k&&t.jsx("div",{className:"mt-2 rounded-[14px] bg-[#f1f5f9] px-3 py-2",children:t.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(a=>t.jsx("button",{type:"button",onClick:()=>x(a),className:"focus:outline-none",children:t.jsxs(J,{tone:"muted",children:["#",a]})},a))})})]})]})})},Ot=({open:n,title:r="Conferma",description:l,confirmLabel:u="Conferma",cancelLabel:g="Annulla",onConfirm:N,onCancel:d,extraAction:m})=>n?t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/35 px-4",children:t.jsxs("div",{className:"w-full max-w-sm rounded-[18px] border border-[rgba(0,0,0,0.06)] bg-white p-5 shadow-[0_30px_80px_-60px_rgba(15,23,42,0.45)]",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("p",{className:"text-base font-semibold text-[#0f172a]",children:r}),l&&t.jsx("p",{className:"text-sm text-[#475569]",children:l})]}),t.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[m,t.jsx("button",{type:"button",onClick:d,className:"rounded-full px-4 py-2 text-sm font-semibold text-[#475569] hover:bg-[#f1f5f9]",children:g}),t.jsx("button",{type:"button",onClick:N,className:"rounded-full bg-[#111111] px-4 py-2 text-sm font-semibold text-white hover:bg-[#0f172a]",children:u})]})]})}):null,ze={id:"",category:"",color:"",season:"Primavera",tags:[],status:"Ready",note:"",updatedAt:new Date().toISOString().split("T")[0],image:void 0},Yt=()=>{const{user:n}=dt(),{t:r}=ie(),l=n?.email||n?.uid||"guest",u=n?.provider!=="local"&&n?.uid||null,g=!!u,{categories:N}=Rt(l),[d,m]=o.useState([]),[k,R]=o.useState(""),[b,w]=o.useState(),[x,T]=o.useState(),[C,I]=o.useState(),[A,E]=o.useState(null),[i,v]=o.useState(ze),[a,j]=o.useState(null),[y,S]=o.useState(""),[D,F]=o.useState(!1),[_,M]=o.useState(""),[U,z]=o.useState(),[H,me]=o.useState(!1),[ue,He]=o.useState(!1),[$,V]=o.useState(!0),[X,Y]=o.useState(null),[fe,Ke]=o.useState(20),[Z,pe]=o.useState(!0),[We,ge]=o.useState(Te(l)),[Q,ee]=o.useState(null),te=o.useRef(null),xe=o.useRef(null),he=o.useRef(null),be=o.useRef(null),we=o.useRef([]),P=o.useRef(!1),ye=o.useRef(null),K=o.useRef(!0),W=o.useRef("idle"),L=o.useRef(null),[qe,ve]=o.useState(null),[Ge,je]=o.useState(null);o.useEffect(()=>{ye.current!==l&&(ye.current=l,P.current=!1,m(Ae(l)),V(mt(l)),pe(ut(l)),ge(Te(l)),P.current=!0)},[l]),o.useEffect(()=>{P.current&&ft(l,d)},[d,l]),o.useEffect(()=>{P.current&&pt(l,$)},[$,l]),o.useEffect(()=>{P.current&&gt(l,Z)},[l,Z]),o.useEffect(()=>{const e=s=>{const c=s.detail;!c||c.profile!==l||c.gender&&ge(c.gender)};return window.addEventListener("ws-profile-updated",e),()=>window.removeEventListener("ws-profile-updated",e)},[l]),o.useEffect(()=>{const e=s=>{const c=s.detail;!c||c.profile!==l||(typeof c.confirmDelete=="boolean"&&V(c.confirmDelete),typeof c.showHoverInfo=="boolean"&&pe(c.showHoverInfo))};return window.addEventListener("ws-preferences-updated",e),()=>window.removeEventListener("ws-preferences-updated",e)},[l]),o.useEffect(()=>{const e=s=>{(s.metaKey||s.ctrlKey)&&s.key.toLowerCase()==="k"&&(s.preventDefault(),xe.current?.focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),o.useEffect(()=>{we.current=d},[d]),o.useEffect(()=>{const e=()=>{!g||!u||(K.current=!0,W.current==="ready"&&P.current&&_e(u,we.current).catch(s=>{console.warn("[firestore] save failed after reconnect, continuing with localStorage",s)}))};return window.addEventListener("online",e),()=>window.removeEventListener("online",e)},[g,u]),o.useEffect(()=>{if(K.current=!0,W.current="idle",L.current&&(window.clearTimeout(L.current),L.current=null),!g||!u||!n)return;let e=!1;return(async()=>{W.current="hydrating";try{await At(n)}catch(s){console.warn("[firestore] profile upsert failed, continuing with localStorage",s)}try{const s=await Dt(u);if(e)return;if(s.length){m(s);return}const c=new Map;[l,n.uid,n.email].filter(Boolean).forEach(h=>{Ae(String(h)).forEach(p=>{p?.id&&c.set(p.id,p)})});const f=[...c.values()];if(f.length)try{await Mt(u,f)}catch(h){console.warn("[firestore] migration failed, continuing with localStorage",h)}}catch(s){K.current=!1,console.warn("[firestore] load failed, continuing with localStorage",s)}finally{W.current="ready"}})(),()=>{e=!0}},[g,u,l,n]),o.useEffect(()=>{if(!(!g||!u)&&K.current&&W.current==="ready"&&P.current)return L.current&&window.clearTimeout(L.current),L.current=window.setTimeout(()=>{_e(u,d).catch(e=>{K.current=!1,console.warn("[firestore] save failed, continuing with localStorage",e)})},900),()=>{L.current&&window.clearTimeout(L.current)}},[g,u,d]);const Ne=o.useMemo(()=>Array.from(new Set(d.map(e=>e.color))),[d]),Ce=o.useMemo(()=>Array.from(new Set(d.map(e=>e.season))),[d]),re=o.useMemo(()=>Array.from(new Set([...N,...d.map(e=>e.category)])).filter(Boolean),[d,N]),$e=o.useMemo(()=>re.map(e=>({value:e,label:ce(e,r)})),[re,r]),Qe=o.useMemo(()=>Ne.filter(Boolean).map(e=>({value:e,label:Ue(e,r)})),[Ne,r]),Je=o.useMemo(()=>Ce.filter(Boolean).map(e=>({value:e,label:Fe(e,r)})),[Ce,r]),oe=o.useMemo(()=>d.filter(e=>{const s=k.trim().toLowerCase(),c=[e.name,e.category,e.color,e.season],f=!s||c.some(ne=>ne?.toString().toLowerCase().includes(s))||(e.tags||[]).some(ne=>ne.toLowerCase().includes(s)),h=!b||e.category===b,p=!x||e.color===x,q=!C||e.season===C;return f&&h&&p&&q}),[b,x,C,k,d]),Se=o.useMemo(()=>oe.slice(0,fe),[oe,fe]),Ve=o.useMemo(()=>({id:"sample",name:r("sample.item.name","Maglietta"),category:r("sample.item.category","Maglietta"),color:r("sample.item.color","Nero"),season:"Primavera",tags:[r("sample.tag.casual","Casual"),r("sample.tag.office","Ufficio")],status:"Ready",note:r("sample.item.note","Esempio di capo con tag e note."),updatedAt:new Date().toISOString().split("T")[0],image:void 0}),[r]),B=!D&&d.length===0&&!k&&!b&&!x&&!C,Xe=B?[Ve]:Se,ke=()=>{const e=y.trim();e&&(i.tags.includes(e)||v({...i,tags:[...i.tags,e]}),S(""))},Ye=e=>{v({...i,tags:i.tags.filter(s=>s!==e)})},Ze=e=>{ee(e),te.current&&window.clearTimeout(te.current),te.current=window.setTimeout(()=>ee(null),4e3)},Re=e=>{m(s=>{const c=s.findIndex(p=>p.id===e);if(c===-1)return s;const f=s[c],h=s.filter((p,q)=>q!==c);return Ze({item:f,index:c}),h})},et=e=>{if(!$){Re(e);return}Y(e)},tt=()=>{X&&(Re(X),Y(null))},rt=We==="male"?Et:Lt,se=()=>{v(ze),S(""),M(""),z(void 0),j(null),F(!1)},ot=e=>{j(e.id),v(e),S(""),M(e.image?.url||""),z(e.image),F(!0)},st=e=>{ve(e.id),be.current?.click()},at=()=>{if(!i.category.trim())return;const e=U||i.image;if(a){m(c=>c.map(f=>f.id===a?{...f,...i,id:a,name:i.category,image:e,updatedAt:new Date().toISOString().split("T")[0]}:f)),se();return}const s=`user-${Date.now()}`;m(c=>[...c,{...i,name:i.category,id:s,image:e,updatedAt:new Date().toISOString().split("T")[0]}]),se()},Ie=async e=>{if(!e||e.length===0)return;const s=e[0];me(!0);try{const{blob:c,dataUrl:f}=await Me(s);let h=c;ue&&(h=await Tt(c));const p=URL.createObjectURL(h);M(p||f);const q=await Pe(h,{removeBackground:!1});z(q)}catch(c){console.error("image handling error",c);const f=URL.createObjectURL(s);M(f),z({url:f,provider:"local",uploadedAt:new Date().toISOString()})}me(!1)},nt=async(e,s)=>{je(s);try{const{blob:c}=await Me(e),f=await Pe(c,{removeBackground:!1});m(h=>h.map(p=>p.id===s?{...p,image:f,updatedAt:new Date().toISOString().split("T")[0]}:p))}catch(c){console.error("replace photo error",c);const f=URL.createObjectURL(e);m(h=>h.map(p=>p.id===s?{...p,image:{url:f,provider:"local",uploadedAt:new Date().toISOString()},updatedAt:new Date().toISOString().split("T")[0]}:p))}finally{je(null)}},ae=e=>{e?.stopPropagation(),he.current?.click()},lt=e=>{e.preventDefault(),Ie(e.dataTransfer.files)},ct=e=>{Ie(e.target.files)},it=async e=>{const s=e.target.files?.[0],c=qe;e.target.value="",!(!s||!c)&&(ve(null),await nt(s,c))},Ee=()=>{const e=navigator.userAgent.toLowerCase();return/iphone|ipad|android|mobile/.test(e)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[t.jsx("div",{className:"w-full flex-1 min-w-[260px]",children:t.jsx(G,{ref:xe,value:k,onChange:e=>R(e.target.value),placeholder:r("home.search"),prefixIcon:t.jsx(vt,{size:16})})}),t.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[t.jsx(le,{label:r("home.filter.category","Capo"),options:$e,value:b,onChange:w,open:A==="category",onOpenChange:e=>E(e?"category":s=>s==="category"?null:s)}),t.jsx(le,{label:r("home.filter.color","Colore"),options:Qe,value:x,onChange:T,open:A==="color",onOpenChange:e=>E(e?"color":s=>s==="color"?null:s)}),t.jsx(le,{label:r("home.filter.season","Stagione"),options:Je,value:C,onChange:I,open:A==="season",onOpenChange:e=>E(e?"season":s=>s==="season"?null:s)}),!D&&t.jsxs(O,{variant:"primary",className:"rounded-full px-4",onClick:()=>F(!0),children:[t.jsx(jt,{size:14,className:"mr-2"})," ",r("home.addItem")]})]})]}),D?t.jsxs(Be,{className:"bg-white/90 ",children:[t.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm font-semibold text-[#0f172a]",children:a?r("home.edit.title","Modifica capo"):r("home.new.title")}),t.jsx("p",{className:"text-[12px] text-[#64748b] sm:text-[13px]",children:a?r("home.edit.subtitle","Aggiorna i dettagli della card."):r("home.new.subtitle")})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(O,{variant:"ghost",className:"rounded-full px-4",onClick:se,children:a?r("home.edit.cancel","Annulla"):r("home.new.cancel")}),t.jsx(O,{variant:"primary",className:"rounded-full px-4",onClick:at,children:a?r("home.edit.save","Salva modifiche"):r("home.new.save")})]})]}),t.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[t.jsxs("div",{onDragOver:e=>e.preventDefault(),onDrop:lt,className:"flex cursor-pointer flex-col items-center justify-center rounded-2xl border border-dashed border-[#cbd5e1] bg-white/80 p-6 text-center text-[#475569] shadow-[0_20px_50px_-40px_rgba(15,23,42,0.55)] ",onClick:ae,children:[_?t.jsx("img",{src:_,alt:"Preview",className:"h-48 w-full rounded-xl object-contain bg-[#f8fafc]"}):t.jsxs("div",{className:"space-y-2",children:[t.jsx(De,{className:"mx-auto text-[#94a3b8]"}),t.jsx("p",{className:"text-sm font-semibold",children:r("home.upload.drag")}),t.jsx("p",{className:"text-[12px] text-[#94a3b8] sm:text-[13px]",children:r("home.upload.click")})]}),t.jsx("div",{className:"mt-3 flex gap-2",children:H?t.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white px-3 py-2 text-sm text-[#475569] shadow-sm",children:[t.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-2 border-[#0f172a] border-t-transparent"}),t.jsx("span",{children:r("home.upload.loading","Caricamento...")})]}):!_&&!U?t.jsxs(t.Fragment,{children:[t.jsxs(O,{variant:"secondary",className:"rounded-full px-3",onClick:ae,children:[t.jsx(De,{size:14,className:"mr-2"})," ",r("home.upload.click")]}),Ee()&&t.jsxs(O,{variant:"ghost",className:"rounded-full px-3",onClick:ae,children:[t.jsx(Nt,{size:14,className:"mr-2"})," ",r("home.upload.click")]})]}):null}),t.jsxs("div",{className:"mt-2 flex items-center gap-2 text-[12px] text-[#475569] sm:text-[13px]",children:[t.jsx("input",{type:"checkbox",id:"remove-bg",checked:ue,onChange:e=>He(e.target.checked),className:"accent-[#0f172a]"}),t.jsx("label",{htmlFor:"remove-bg",children:r("home.upload.removeBg")})]}),t.jsx("input",{ref:he,type:"file",accept:"image/*",capture:Ee()?"environment":void 0,className:"hidden",onChange:ct})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx(G,{placeholder:r("home.fields.category","Categoria"),list:"category-options",value:i.category,onChange:e=>v({...i,category:e.target.value})}),t.jsx("datalist",{id:"category-options",children:re.map(e=>t.jsx("option",{value:e},e))}),t.jsx(G,{placeholder:r("home.fields.color","Colore"),value:i.color,onChange:e=>v({...i,color:e.target.value})}),t.jsx(G,{placeholder:r("home.fields.season","Stagione (Primavera/Estate/Autunno/Inverno)"),value:i.season,onChange:e=>v({...i,season:e.target.value})}),t.jsx(G,{placeholder:r("home.fields.note","Note"),value:i.note,onChange:e=>v({...i,note:e.target.value})})]})]}),t.jsxs("div",{className:"mt-4",children:[t.jsx("label",{className:"text-[12px] uppercase tracking-[0.3em] text-[#94a3b8] sm:text-[13px]",children:r("home.tags.label","Tag (facoltativi)")}),t.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[i.tags.map(e=>t.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/70 px-3 py-1 text-sm text-[#0f172a] shadow-sm ",children:[e,t.jsx("button",{"aria-label":`${r("common.remove","Rimuovi")} ${e}`,onClick:()=>Ye(e),className:"text-[#cbd5e1] hover:text-[#ef4444]",children:"×"})]},e)),t.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-[rgba(255,255,255,0.45)] bg-white/70 px-3 py-1 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.6)] ",children:[t.jsx(Ct,{size:14,className:"text-[#94a3b8]"}),t.jsx("input",{className:"w-32 bg-transparent text-sm text-[#0f172a] placeholder:text-[#94a3b8] focus:outline-none",placeholder:r("home.tags.add","Aggiungi tag"),value:y,onChange:e=>S(e.target.value),onKeyDown:e=>{(e.key==="Enter"||e.key===",")&&(e.preventDefault(),ke())}}),t.jsx("button",{type:"button",className:"text-[12px] font-semibold text-[#475569] hover:text-[#0f172a] sm:text-[13px]",onClick:ke,children:r("common.add","Add")})]})]})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Xe.map(e=>t.jsx(Bt,{item:e,fallbackImage:rt,onSelectTerm:B?void 0:s=>{R(s),w(void 0),T(void 0),I(void 0)},onDelete:B?void 0:et,onEdit:B?void 0:ot,onReplacePhoto:B||Ge===e.id?void 0:st,showHoverInfo:Z},e.id))}),oe.length>Se.length&&t.jsx("div",{className:"flex justify-center",children:t.jsx(O,{variant:"secondary",className:"rounded-full px-4",onClick:()=>Ke(e=>e+20),children:r("home.showMore","Mostra altri {count}",{count:20})})})]}),!D&&d.length===0&&!B&&t.jsx("div",{className:"flex justify-center pt-4",children:t.jsx("p",{className:"text-[11px] text-[#94a3b8]/70 sm:text-[12px]",children:r("home.emptyHint")})}),t.jsx(Ot,{open:!!X,title:r("dialog.delete.title","Eliminare il capo?"),description:r("dialog.delete.desc","Questa operazione rimuove la card dal tuo guardaroba."),onCancel:()=>Y(null),onConfirm:tt,extraAction:t.jsxs("label",{className:"flex items-center gap-2 text-[12px] font-semibold text-[#475569] sm:text-[13px]",children:[t.jsx("input",{type:"checkbox",checked:!$,onChange:e=>V(!e.target.checked),className:"accent-[#0f172a]"}),r("dialog.delete.noAsk","Non chiedere più")]})}),t.jsx(It,{open:!!Q,message:r("toast.itemRemoved","Capo rimosso"),actionLabel:r("toast.undo","Annulla"),onUndo:()=>{Q&&m(e=>{const s=[...e];return s.splice(Math.min(Q.index,s.length),0,Q.item),s})},onClose:()=>ee(null)}),t.jsx("input",{ref:be,type:"file",accept:"image/*",className:"hidden",onChange:it})]})};export{Yt as HomePage};
