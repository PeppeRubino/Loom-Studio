import{r as o,j as e,a0 as Ie}from"./vendor-77yDWcJJ.js";import{B as E}from"./Button-CI2oUu3j.js";import{C as Me}from"./Card-B3nxRyRw.js";import{a as ae,u as ct,d as Re,e as Ee,b as it,l as mt,f as dt,c as ut,s as ft}from"./index-D7D3au-C.js";import{C as _e,E as pt,T as gt,R as xt,b as ht,c as bt,S as yt,P as wt,I as Te,d as vt,e as jt}from"./icons-DL2PgYE_.js";import{A as Nt,m as Ct}from"./motion-KXh7TDlr.js";import{I as L}from"./Input-Bi6IGvP7.js";import{u as kt,U as St}from"./useCategorySettings-DCQ8-ADA.js";import{f as It,a as Rt,c as Pe,r as Et,u as Ae}from"./fallback_m-BEWCsPdO.js";import{upsertUserProfileFromAuth as Tt,loadWardrobeFromFirestore as Pt,migrateLocalToFirestoreIfNeeded as At,saveWardrobeToFirestore as De}from"./wardrobeStore-DvZzQvYc.js";import"./firebase-DCzW8K6T.js";import"./router-YYQTkf18.js";const oe=({label:a,options:r,value:n,onChange:d})=>{const{t:h}=ae(),[v,c]=o.useState(!1),i=n?r.find(g=>g.value===n)?.label??n:void 0;return e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",className:Ie("flex items-center gap-2 rounded-full border border-[rgba(0,0,0,0.04)] bg-white/55 px-3.5 py-[5px] text-sm text-[#0f172a] shadow-[0_8px_20px_-20px_rgba(15,23,42,0.3)] transition duration-[120ms]",v&&"ring-2 ring-[#c1124d]/20"),onClick:()=>c(g=>!g),children:[e.jsx("span",{children:i||a}),e.jsx(_e,{size:14,className:"text-[#94a3b8]"})]}),e.jsx(Nt,{children:v&&e.jsxs(Ct.div,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:-6},transition:{duration:.12},className:"absolute right-0 z-20 mt-2 w-44 rounded-2xl border border-[rgba(255,255,255,0.6)] bg-white/80 p-2 shadow-lg ",children:[e.jsx("button",{className:"w-full rounded-xl px-3 py-2 text-left text-sm text-[#475569] hover:bg-[#f8fafc]",onClick:()=>{d(void 0),c(!1)},children:h("common.all","Tutti")}),r.map(g=>e.jsx("button",{className:Ie("w-full rounded-xl px-3 py-2 text-left text-sm text-[#0f172a] hover:bg-[#f8fafc]",n===g.value&&"bg-[#f1f5f9] font-semibold"),onClick:()=>{d(g.value),c(!1)},children:g.label},g.value))]})})]})},Dt={accent:"border border-transparent text-[#b11226]",neutral:"border border-[rgba(0,0,0,0.08)] text-[#0f172a]",muted:"border border-[rgba(0,0,0,0.06)] text-[#475569]"},K=({children:a,tone:r="neutral"})=>{const n=r??"neutral";return e.jsx("span",{className:`user-select-none inline-flex items-center gap-1 rounded-full px-2.5 py-0.5 text-[11px] font-medium antialiased shadow-[0_6px_14px_-10px_rgba(15,23,42,0.14)] transition-shadow focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-[#0f172a]/20 sm:text-[12px] ${Dt[n]}`,children:a})},Lt=a=>a.trim().toLowerCase().replace(/\s+/g," ").replace(/[’']/g,"'"),Mt={primavera:"term.season.spring",spring:"term.season.spring",春:"term.season.spring",весна:"term.season.spring",estate:"term.season.summer",summer:"term.season.summer",夏:"term.season.summer",лето:"term.season.summer",autunno:"term.season.autumn",autumn:"term.season.autumn",fall:"term.season.autumn",秋:"term.season.autumn",осень:"term.season.autumn",inverno:"term.season.winter",winter:"term.season.winter",冬:"term.season.winter",зима:"term.season.winter",maglietta:"term.category.tshirt",tshirt:"term.category.tshirt","t-shirt":"term.category.tshirt","t shirt":"term.category.tshirt",футболка:"term.category.tshirt",tシャツ:"term.category.tshirt",camicia:"term.category.shirt",shirt:"term.category.shirt",рубашка:"term.category.shirt",シャツ:"term.category.shirt",pantaloni:"term.category.pants",pants:"term.category.pants",trousers:"term.category.pants",брюки:"term.category.pants",パンツ:"term.category.pants",scarpe:"term.category.shoes",shoes:"term.category.shoes",обувь:"term.category.shoes",靴:"term.category.shoes",giacca:"term.category.jacket",jacket:"term.category.jacket",куртка:"term.category.jacket",ジャケット:"term.category.jacket",cappotto:"term.category.coat",coat:"term.category.coat",пальто:"term.category.coat",コート:"term.category.coat",felpa:"term.category.hoodie",hoodie:"term.category.hoodie",sweatshirt:"term.category.hoodie",худи:"term.category.hoodie",パーカー:"term.category.hoodie",vestito:"term.category.dress",dress:"term.category.dress",платье:"term.category.dress",ワンピース:"term.category.dress",gonna:"term.category.skirt",skirt:"term.category.skirt",юбка:"term.category.skirt",スカート:"term.category.skirt",accessori:"term.category.accessories",accessories:"term.category.accessories",аксессуары:"term.category.accessories",アクセサリー:"term.category.accessories",nero:"term.color.black",black:"term.color.black",黒:"term.color.black",чёрный:"term.color.black",черный:"term.color.black",bianco:"term.color.white",white:"term.color.white",白:"term.color.white",белый:"term.color.white",grigio:"term.color.gray",grey:"term.color.gray",gray:"term.color.gray",灰:"term.color.gray",серый:"term.color.gray",blu:"term.color.blue",blue:"term.color.blue",青:"term.color.blue",синий:"term.color.blue",rosso:"term.color.red",red:"term.color.red",赤:"term.color.red",красный:"term.color.red",verde:"term.color.green",green:"term.color.green",緑:"term.color.green",зелёный:"term.color.green",зеленый:"term.color.green",giallo:"term.color.yellow",yellow:"term.color.yellow",黄:"term.color.yellow",жёлтый:"term.color.yellow",желтый:"term.color.yellow",rosa:"term.color.pink",pink:"term.color.pink",ピンク:"term.color.pink",розовый:"term.color.pink",viola:"term.color.purple",purple:"term.color.purple",紫:"term.color.purple",фиолетовый:"term.color.purple",marrone:"term.color.brown",brown:"term.color.brown",茶:"term.color.brown",коричневый:"term.color.brown",beige:"term.color.beige",ベージュ:"term.color.beige",бежевый:"term.color.beige",arancione:"term.color.orange",orange:"term.color.orange",オレンジ:"term.color.orange",оранжевый:"term.color.orange"},ne=(a,r)=>{const n=Mt[Lt(a)];return n?r(n,a):a},ze=(a,r)=>ne(a,r),se=(a,r)=>ne(a,r),Be=(a,r)=>ne(a,r),_t=({item:a,onSelectTerm:r,onDelete:n,onEdit:d,onReplacePhoto:h,showHoverInfo:v=!0,fallbackImage:c=""})=>{const{t:i}=ae(),[g,M]=o.useState(!1),[N,C]=o.useState(!1),b=p=>{p&&r?.(p)},_=[...a.tags].sort((p,I)=>p.localeCompare(I,"it",{sensitivity:"base"})),k=a.image?.url||c,z=!!(n||d||h),m=se(a.name||a.category,i),y=se(a.category,i),w=Be(a.color,i),T=ze(a.season,i);return e.jsx("div",{className:"transition-shadow duration-[120ms]",children:e.jsxs(Me,{className:"p-3",children:[e.jsxs("div",{className:"group relative aspect-square overflow-hidden rounded-[14px] bg-[#f8fafc] p-3 flex items-center justify-center",children:[e.jsx("img",{src:k,alt:a.name,className:"max-h-[60%] w-full object-contain",loading:"lazy",onError:p=>{c&&(p.target.src=c)}}),v&&e.jsx("div",{className:"pointer-events-none absolute inset-0 flex flex-col justify-end bg-gradient-to-t from-black/55 via-black/20 to-transparent p-3 text-white opacity-0 transition-opacity duration-[120ms] group-hover:opacity-100",children:a.note?e.jsx("p",{className:"text-[12px] text-white/90 line-clamp-3 sm:text-[13px]",children:a.note}):e.jsx("p",{className:"text-[12px] text-white/70 sm:text-[13px]",children:i("garment.noNote","Nessuna nota")})})]}),e.jsxs("div",{className:"mt-3 flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-base font-semibold text-[#0f172a] leading-tight",children:m}),e.jsxs("p",{className:"text-sm text-[#64748b]",children:[w," · ",T]})]}),z&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",className:"rounded-full bg-white/70 p-2 text-[#94a3b8] shadow-sm hover:text-[#0f172a]","aria-label":i("garment.menu","Menu"),onClick:()=>C(p=>!p),children:e.jsx(pt,{size:14})}),N&&e.jsxs("div",{className:"absolute right-0 z-20 mt-2 w-44 rounded-2xl border border-[rgba(0,0,0,0.08)] bg-white p-2 shadow-lg",children:[e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#0f172a] hover:bg-[#f7f7f8]",onClick:()=>{C(!1),n?.(a.id)},children:[e.jsx(gt,{size:14})," ",i("garment.remove","Rimuovi")]}),e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#475569] hover:bg-[#f7f7f8]",onClick:()=>{C(!1),d?.(a)},disabled:!d,children:[e.jsx(xt,{size:14})," ",i("garment.edit","Modifica")]}),e.jsxs("button",{className:"flex w-full items-center gap-2 rounded-xl px-3 py-2 text-sm text-[#475569] hover:bg-[#f7f7f8]",onClick:()=>{C(!1),h?.(a)},disabled:!h,children:[e.jsx(ht,{size:14})," ",i("garment.replacePhoto","Sostituisci foto")]})]})]})]}),e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[e.jsx("button",{type:"button",onClick:()=>b(a.category),className:"focus:outline-none",children:e.jsx(K,{tone:"neutral",children:y})}),e.jsx("button",{type:"button",onClick:()=>b(a.color),className:"focus:outline-none",children:e.jsx(K,{tone:"neutral",children:w})}),e.jsx("button",{type:"button",onClick:()=>b(a.season),className:"focus:outline-none",children:e.jsx(K,{tone:"neutral",children:T})})]}),a.tags.length>0&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("button",{type:"button",onClick:()=>M(p=>!p),className:"flex items-center gap-2 text-[12px] font-semibold uppercase tracking-[0.2em] text-[#475569] hover:text-[#0f172a] sm:text-[13px]",children:[g?e.jsx(bt,{size:14}):e.jsx(_e,{size:14}),i("garment.tags","Tag")]}),g&&e.jsx("div",{className:"mt-2 rounded-[14px] bg-[#f1f5f9] px-3 py-2",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:_.map(p=>e.jsx("button",{type:"button",onClick:()=>b(p),className:"focus:outline-none",children:e.jsxs(K,{tone:"muted",children:["#",p]})},p))})})]})]})})},zt=({open:a,title:r="Conferma",description:n,confirmLabel:d="Conferma",cancelLabel:h="Annulla",onConfirm:v,onCancel:c,extraAction:i})=>a?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/35 px-4",children:e.jsxs("div",{className:"w-full max-w-sm rounded-[18px] border border-[rgba(0,0,0,0.06)] bg-white p-5 shadow-[0_30px_80px_-60px_rgba(15,23,42,0.45)]",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-base font-semibold text-[#0f172a]",children:r}),n&&e.jsx("p",{className:"text-sm text-[#475569]",children:n})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-end gap-2",children:[i,e.jsx("button",{type:"button",onClick:c,className:"rounded-full px-4 py-2 text-sm font-semibold text-[#475569] hover:bg-[#f1f5f9]",children:h}),e.jsx("button",{type:"button",onClick:v,className:"rounded-full bg-[#111111] px-4 py-2 text-sm font-semibold text-white hover:bg-[#0f172a]",children:d})]})]})}):null,Le={id:"",category:"",color:"",season:"Primavera",tags:[],status:"Ready",note:"",updatedAt:new Date().toISOString().split("T")[0],image:void 0},Vt=()=>{const{user:a}=ct(),{t:r}=ae(),n=a?.email||a?.uid||"guest",d=a?.provider!=="local"&&a?.uid||null,h=!!d,{categories:v}=kt(n),[c,i]=o.useState([]),[g,M]=o.useState(""),[N,C]=o.useState(),[b,_]=o.useState(),[k,z]=o.useState(),[m,y]=o.useState(Le),[w,T]=o.useState(null),[p,I]=o.useState(""),[B,G]=o.useState(!1),[$,U]=o.useState(""),[le,O]=o.useState(),[Ue,ce]=o.useState(!1),[ie,Oe]=o.useState(!1),[F,q]=o.useState(!0),[W,Q]=o.useState(null),[me,Fe]=o.useState(20),[J,de]=o.useState(!0),[He,ue]=o.useState(Re(n)),[H,V]=o.useState(null),X=o.useRef(null),fe=o.useRef(null),pe=o.useRef(null),ge=o.useRef(null),xe=o.useRef([]),S=o.useRef(!1),he=o.useRef(null),P=o.useRef(!0),A=o.useRef("idle"),j=o.useRef(null),[Ke,be]=o.useState(null),[Ge,ye]=o.useState(null);o.useEffect(()=>{he.current!==n&&(he.current=n,S.current=!1,i(Ee(n)),q(it(n)),de(mt(n)),ue(Re(n)),S.current=!0)},[n]),o.useEffect(()=>{S.current&&dt(n,c)},[c,n]),o.useEffect(()=>{S.current&&ut(n,F)},[F,n]),o.useEffect(()=>{S.current&&ft(n,J)},[n,J]),o.useEffect(()=>{const t=s=>{const l=s.detail;!l||l.profile!==n||l.gender&&ue(l.gender)};return window.addEventListener("ws-profile-updated",t),()=>window.removeEventListener("ws-profile-updated",t)},[n]),o.useEffect(()=>{const t=s=>{const l=s.detail;!l||l.profile!==n||(typeof l.confirmDelete=="boolean"&&q(l.confirmDelete),typeof l.showHoverInfo=="boolean"&&de(l.showHoverInfo))};return window.addEventListener("ws-preferences-updated",t),()=>window.removeEventListener("ws-preferences-updated",t)},[n]),o.useEffect(()=>{const t=s=>{(s.metaKey||s.ctrlKey)&&s.key.toLowerCase()==="k"&&(s.preventDefault(),fe.current?.focus())};return window.addEventListener("keydown",t),()=>window.removeEventListener("keydown",t)},[]),o.useEffect(()=>{xe.current=c},[c]),o.useEffect(()=>{const t=()=>{!h||!d||(P.current=!0,A.current==="ready"&&S.current&&De(d,xe.current).catch(s=>{console.warn("[firestore] save failed after reconnect, continuing with localStorage",s)}))};return window.addEventListener("online",t),()=>window.removeEventListener("online",t)},[h,d]),o.useEffect(()=>{if(P.current=!0,A.current="idle",j.current&&(window.clearTimeout(j.current),j.current=null),!h||!d||!a)return;let t=!1;return(async()=>{A.current="hydrating";try{await Tt(a)}catch(s){console.warn("[firestore] profile upsert failed, continuing with localStorage",s)}try{const s=await Pt(d);if(t)return;if(s.length){i(s);return}const l=new Map;[n,a.uid,a.email].filter(Boolean).forEach(x=>{Ee(String(x)).forEach(f=>{f?.id&&l.set(f.id,f)})});const u=[...l.values()];if(u.length)try{await At(d,u)}catch(x){console.warn("[firestore] migration failed, continuing with localStorage",x)}}catch(s){P.current=!1,console.warn("[firestore] load failed, continuing with localStorage",s)}finally{A.current="ready"}})(),()=>{t=!0}},[h,d,n,a]),o.useEffect(()=>{if(!(!h||!d)&&P.current&&A.current==="ready"&&S.current)return j.current&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>{De(d,c).catch(t=>{P.current=!1,console.warn("[firestore] save failed, continuing with localStorage",t)})},900),()=>{j.current&&window.clearTimeout(j.current)}},[h,d,c]);const we=o.useMemo(()=>Array.from(new Set(c.map(t=>t.color))),[c]),ve=o.useMemo(()=>Array.from(new Set(c.map(t=>t.season))),[c]),Y=o.useMemo(()=>Array.from(new Set([...v,...c.map(t=>t.category)])).filter(Boolean),[c,v]),$e=o.useMemo(()=>Y.map(t=>({value:t,label:se(t,r)})),[Y,r]),qe=o.useMemo(()=>we.filter(Boolean).map(t=>({value:t,label:Be(t,r)})),[we,r]),We=o.useMemo(()=>ve.filter(Boolean).map(t=>({value:t,label:ze(t,r)})),[ve,r]),Z=o.useMemo(()=>c.filter(t=>{const s=g.trim().toLowerCase(),l=[t.name,t.category,t.color,t.season],u=!s||l.some(re=>re?.toString().toLowerCase().includes(s))||(t.tags||[]).some(re=>re.toLowerCase().includes(s)),x=!N||t.category===N,f=!b||t.color===b,D=!k||t.season===k;return u&&x&&f&&D}),[N,b,k,g,c]),je=o.useMemo(()=>Z.slice(0,me),[Z,me]),Qe=o.useMemo(()=>({id:"sample",name:r("sample.item.name","Maglietta"),category:r("sample.item.category","Maglietta"),color:r("sample.item.color","Nero"),season:"Primavera",tags:[r("sample.tag.casual","Casual"),r("sample.tag.office","Ufficio")],status:"Ready",note:r("sample.item.note","Esempio di capo con tag e note."),updatedAt:new Date().toISOString().split("T")[0],image:void 0}),[r]),R=!B&&c.length===0&&!g&&!N&&!b&&!k,Je=R?[Qe]:je,Ne=()=>{const t=p.trim();t&&(m.tags.includes(t)||y({...m,tags:[...m.tags,t]}),I(""))},Ve=t=>{y({...m,tags:m.tags.filter(s=>s!==t)})},Xe=t=>{V(t),X.current&&window.clearTimeout(X.current),X.current=window.setTimeout(()=>V(null),4e3)},Ce=t=>{i(s=>{const l=s.findIndex(f=>f.id===t);if(l===-1)return s;const u=s[l],x=s.filter((f,D)=>D!==l);return Xe({item:u,index:l}),x})},Ye=t=>{if(!F){Ce(t);return}Q(t)},Ze=()=>{W&&(Ce(W),Q(null))},et=He==="male"?It:Rt,ee=()=>{y(Le),I(""),U(""),O(void 0),T(null),G(!1)},tt=t=>{T(t.id),y(t),I(""),U(t.image?.url||""),O(t.image),G(!0)},rt=t=>{be(t.id),ge.current?.click()},ot=()=>{if(!m.category.trim())return;const t=le||m.image;if(w){i(l=>l.map(u=>u.id===w?{...u,...m,id:w,name:m.category,image:t,updatedAt:new Date().toISOString().split("T")[0]}:u)),ee();return}const s=`user-${Date.now()}`;i(l=>[...l,{...m,name:m.category,id:s,image:t,updatedAt:new Date().toISOString().split("T")[0]}]),ee()},ke=async t=>{if(!t||t.length===0)return;const s=t[0];ce(!0);try{const{blob:l,dataUrl:u}=await Pe(s);let x=l;ie&&(x=await Et(l));const f=URL.createObjectURL(x);U(f||u);const D=await Ae(x,{removeBackground:!1});O(D)}catch(l){console.error("image handling error",l);const u=URL.createObjectURL(s);U(u),O({url:u,provider:"local",uploadedAt:new Date().toISOString()})}ce(!1)},st=async(t,s)=>{ye(s);try{const{blob:l}=await Pe(t),u=await Ae(l,{removeBackground:!1});i(x=>x.map(f=>f.id===s?{...f,image:u,updatedAt:new Date().toISOString().split("T")[0]}:f))}catch(l){console.error("replace photo error",l);const u=URL.createObjectURL(t);i(x=>x.map(f=>f.id===s?{...f,image:{url:u,provider:"local",uploadedAt:new Date().toISOString()},updatedAt:new Date().toISOString().split("T")[0]}:f))}finally{ye(null)}},te=t=>{t?.stopPropagation(),pe.current?.click()},at=t=>{t.preventDefault(),ke(t.dataTransfer.files)},nt=t=>{ke(t.target.files)},lt=async t=>{const s=t.target.files?.[0],l=Ke;t.target.value="",!(!s||!l)&&(be(null),await st(s,l))},Se=()=>{const t=navigator.userAgent.toLowerCase();return/iphone|ipad|android|mobile/.test(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsx("div",{className:"w-full flex-1 min-w-[260px]",children:e.jsx(L,{ref:fe,value:g,onChange:t=>M(t.target.value),placeholder:r("home.search"),prefixIcon:e.jsx(yt,{size:16})})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx(oe,{label:r("home.filter.category","Capo"),options:$e,value:N,onChange:C}),e.jsx(oe,{label:r("home.filter.color","Colore"),options:qe,value:b,onChange:_}),e.jsx(oe,{label:r("home.filter.season","Stagione"),options:We,value:k,onChange:z}),!B&&e.jsxs(E,{variant:"primary",className:"rounded-full px-4",onClick:()=>G(!0),children:[e.jsx(wt,{size:14,className:"mr-2"})," ",r("home.addItem")]})]})]}),B?e.jsxs(Me,{className:"bg-white/90 ",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-[#0f172a]",children:w?r("home.edit.title","Modifica capo"):r("home.new.title")}),e.jsx("p",{className:"text-[12px] text-[#64748b] sm:text-[13px]",children:w?r("home.edit.subtitle","Aggiorna i dettagli della card."):r("home.new.subtitle")})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(E,{variant:"ghost",className:"rounded-full px-4",onClick:ee,children:w?r("home.edit.cancel","Annulla"):r("home.new.cancel")}),e.jsx(E,{variant:"primary",className:"rounded-full px-4",onClick:ot,children:w?r("home.edit.save","Salva modifiche"):r("home.new.save")})]})]}),e.jsxs("div",{className:"mt-4 grid gap-4 md:grid-cols-2",children:[e.jsxs("div",{onDragOver:t=>t.preventDefault(),onDrop:at,className:"flex cursor-pointer flex-col items-center justify-center rounded-2xl border border-dashed border-[#cbd5e1] bg-white/80 p-6 text-center text-[#475569] shadow-[0_20px_50px_-40px_rgba(15,23,42,0.55)] ",onClick:te,children:[$?e.jsx("img",{src:$,alt:"Preview",className:"h-48 w-full rounded-xl object-contain bg-[#f8fafc]"}):e.jsxs("div",{className:"space-y-2",children:[e.jsx(Te,{className:"mx-auto text-[#94a3b8]"}),e.jsx("p",{className:"text-sm font-semibold",children:r("home.upload.drag")}),e.jsx("p",{className:"text-[12px] text-[#94a3b8] sm:text-[13px]",children:r("home.upload.click")})]}),e.jsx("div",{className:"mt-3 flex gap-2",children:Ue?e.jsxs("div",{className:"inline-flex items-center gap-2 rounded-full bg-white px-3 py-2 text-sm text-[#475569] shadow-sm",children:[e.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-2 border-[#0f172a] border-t-transparent"}),e.jsx("span",{children:r("home.upload.loading","Caricamento...")})]}):!$&&!le?e.jsxs(e.Fragment,{children:[e.jsxs(E,{variant:"secondary",className:"rounded-full px-3",onClick:te,children:[e.jsx(Te,{size:14,className:"mr-2"})," ",r("home.upload.click")]}),Se()&&e.jsxs(E,{variant:"ghost",className:"rounded-full px-3",onClick:te,children:[e.jsx(vt,{size:14,className:"mr-2"})," ",r("home.upload.click")]})]}):null}),e.jsxs("div",{className:"mt-2 flex items-center gap-2 text-[12px] text-[#475569] sm:text-[13px]",children:[e.jsx("input",{type:"checkbox",id:"remove-bg",checked:ie,onChange:t=>Oe(t.target.checked),className:"accent-[#0f172a]"}),e.jsx("label",{htmlFor:"remove-bg",children:r("home.upload.removeBg")})]}),e.jsx("input",{ref:pe,type:"file",accept:"image/*",capture:Se()?"environment":void 0,className:"hidden",onChange:nt})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(L,{placeholder:r("home.fields.category","Categoria"),list:"category-options",value:m.category,onChange:t=>y({...m,category:t.target.value})}),e.jsx("datalist",{id:"category-options",children:Y.map(t=>e.jsx("option",{value:t},t))}),e.jsx(L,{placeholder:r("home.fields.color","Colore"),value:m.color,onChange:t=>y({...m,color:t.target.value})}),e.jsx(L,{placeholder:r("home.fields.season","Stagione (Primavera/Estate/Autunno/Inverno)"),value:m.season,onChange:t=>y({...m,season:t.target.value})}),e.jsx(L,{placeholder:r("home.fields.note","Note"),value:m.note,onChange:t=>y({...m,note:t.target.value})})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"text-[12px] uppercase tracking-[0.3em] text-[#94a3b8] sm:text-[13px]",children:r("home.tags.label","Tag (facoltativi)")}),e.jsxs("div",{className:"mt-2 flex flex-wrap items-center gap-2",children:[m.tags.map(t=>e.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/70 px-3 py-1 text-sm text-[#0f172a] shadow-sm ",children:[t,e.jsx("button",{"aria-label":`${r("common.remove","Rimuovi")} ${t}`,onClick:()=>Ve(t),className:"text-[#cbd5e1] hover:text-[#ef4444]",children:"×"})]},t)),e.jsxs("div",{className:"flex items-center gap-2 rounded-full border border-[rgba(255,255,255,0.45)] bg-white/70 px-3 py-1 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.6)] ",children:[e.jsx(jt,{size:14,className:"text-[#94a3b8]"}),e.jsx("input",{className:"w-32 bg-transparent text-sm text-[#0f172a] placeholder:text-[#94a3b8] focus:outline-none",placeholder:r("home.tags.add","Aggiungi tag"),value:p,onChange:t=>I(t.target.value),onKeyDown:t=>{(t.key==="Enter"||t.key===",")&&(t.preventDefault(),Ne())}}),e.jsx("button",{type:"button",className:"text-[12px] font-semibold text-[#475569] hover:text-[#0f172a] sm:text-[13px]",onClick:Ne,children:r("common.add","Add")})]})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:Je.map(t=>e.jsx(_t,{item:t,fallbackImage:et,onSelectTerm:R?void 0:s=>{M(s),C(void 0),_(void 0),z(void 0)},onDelete:R?void 0:Ye,onEdit:R?void 0:tt,onReplacePhoto:R||Ge===t.id?void 0:rt,showHoverInfo:J},t.id))}),Z.length>je.length&&e.jsx("div",{className:"flex justify-center",children:e.jsx(E,{variant:"secondary",className:"rounded-full px-4",onClick:()=>Fe(t=>t+20),children:r("home.showMore","Mostra altri {count}",{count:20})})})]}),!B&&c.length===0&&!R&&e.jsx("div",{className:"flex justify-center pt-4",children:e.jsx("p",{className:"text-[11px] text-[#94a3b8]/70 sm:text-[12px]",children:r("home.emptyHint")})}),e.jsx(zt,{open:!!W,title:r("dialog.delete.title","Eliminare il capo?"),description:r("dialog.delete.desc","Questa operazione rimuove la card dal tuo guardaroba."),onCancel:()=>Q(null),onConfirm:Ze,extraAction:e.jsxs("label",{className:"flex items-center gap-2 text-[12px] font-semibold text-[#475569] sm:text-[13px]",children:[e.jsx("input",{type:"checkbox",checked:!F,onChange:t=>q(!t.target.checked),className:"accent-[#0f172a]"}),r("dialog.delete.noAsk","Non chiedere più")]})}),e.jsx(St,{open:!!H,message:r("toast.itemRemoved","Capo rimosso"),actionLabel:r("toast.undo","Annulla"),onUndo:()=>{H&&i(t=>{const s=[...t];return s.splice(Math.min(H.index,s.length),0,H.item),s})},onClose:()=>V(null)}),e.jsx("input",{ref:ge,type:"file",accept:"image/*",className:"hidden",onChange:lt})]})};export{Vt as HomePage};
