import{r as a,j as e}from"./vendor-77yDWcJJ.js";import{B as O}from"./Button-CI2oUu3j.js";import{I as D}from"./Input-Bi6IGvP7.js";import{u as H,U as R}from"./useCategorySettings-DCQ8-ADA.js";import{u as A,a as z,l as T,b as U,s as $,c as B}from"./index-CrqZLxMN.js";import{A as M,m as N}from"./motion-KXh7TDlr.js";import{X as C,C as _,P as F,H as J,a as K,M as X}from"./icons-DL2PgYE_.js";import{L as k,O as q}from"./router-YYQTkf18.js";import"./firebase-DCzW8K6T.js";const G=({open:c,onClose:o})=>{const{user:i}=A(),r=i?.email||i?.uid||"guest",{categories:f,addCategory:x,removeCategory:d}=H(r),{t}=z(),[n,m]=a.useState(""),[u,p]=a.useState(!0),[h,b]=a.useState(!0),[v,S]=a.useState(!1),[y,E]=a.useState(!1),[g,w]=a.useState(null),j=a.useRef(null);a.useEffect(()=>{p(T(r)),b(U(r))},[r]),a.useEffect(()=>{const s=I=>{const l=I.detail;!l||l.profile!==r||(typeof l.confirmDelete=="boolean"&&b(l.confirmDelete),typeof l.showHoverInfo=="boolean"&&p(l.showHoverInfo))};return window.addEventListener("ws-preferences-updated",s),()=>window.removeEventListener("ws-preferences-updated",s)},[r]),a.useEffect(()=>{$(r,u)},[r,u]),a.useEffect(()=>{B(r,h)},[r,h]);const L=()=>{x(n.trim()),m("")},P=s=>{d(s),w(s),j.current&&window.clearTimeout(j.current),j.current=window.setTimeout(()=>w(null),4e3)};return e.jsxs(e.Fragment,{children:[e.jsx(M,{children:c&&e.jsxs(N.div,{className:"fixed inset-0 z-40 flex justify-end bg-black/25 ",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[e.jsx("div",{className:"h-full w-full",onClick:o,"aria-hidden":!0}),e.jsxs(N.aside,{initial:{x:320},animate:{x:0},exit:{x:320},transition:{duration:.18,ease:"easeOut"},className:"relative z-50 flex h-full w-[360px] flex-col gap-4 border-l border-[#e2e8f0] bg-white p-5 shadow-[0_30px_80px_-60px_rgba(15,23,42,0.55)]",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-semibold text-[#0f172a]",children:t("drawer.categories","Categorie personalizzate")}),e.jsxs("p",{className:"text-[12px] text-[#64748b] sm:text-[13px]",children:[t("drawer.profile","Profilo"),": ",i?.email||"ospite"]})]}),e.jsx("button",{"aria-label":t("common.close","Chiudi"),onClick:o,className:"rounded-full p-2 text-[#94a3b8] hover:bg-[#f1f5f9]",children:e.jsx(C,{size:16})})]}),e.jsxs("section",{className:"rounded-2xl border border-[#e2e8f0] bg-white shadow-[0_12px_30px_-24px_rgba(15,23,42,0.35)]",children:[e.jsxs("button",{type:"button",onClick:()=>S(s=>!s),className:"flex w-full items-center justify-between px-3 py-2 text-sm font-semibold text-[#0f172a]",children:[e.jsx("span",{children:t("drawer.categories","Categorie personalizzate")}),e.jsx(_,{size:16,className:`text-[#94a3b8] transition-transform duration-[120ms] ${v?"":"rotate-180"}`})]}),v&&e.jsxs("div",{className:"space-y-3 px-3 pb-3",children:[e.jsx(D,{placeholder:t("drawer.newCategory","Nuova categoria (es. Maglietta)"),value:n,onChange:s=>m(s.target.value)}),e.jsxs(O,{variant:"secondary",className:"w-full rounded-full",onClick:L,children:[e.jsx(F,{size:14,className:"mr-2"})," ",t("drawer.addCategory","Aggiungi categoria")]}),e.jsx("div",{className:"max-h-64 space-y-2 overflow-y-auto pr-1",children:f.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-2xl border border-[#e2e8f0] bg-white px-3 py-2 shadow-[0_12px_30px_-24px_rgba(15,23,42,0.35)]",children:[e.jsx("p",{className:"text-sm font-semibold text-[#0f172a]",children:s}),e.jsx("button",{"aria-label":`${t("common.remove","Rimuovi")} ${s}`,onClick:()=>P(s),className:"rounded-full p-2 text-[#cbd5e1] hover:bg-[#f8fafc] hover:text-[#ef4444]",children:e.jsx(C,{size:14})})]},s))})]})]}),e.jsxs("section",{className:"rounded-2xl border border-[#e2e8f0] bg-white shadow-[0_12px_30px_-24px_rgba(15,23,42,0.35)]",children:[e.jsxs("button",{type:"button",onClick:()=>E(s=>!s),className:"flex w-full items-center justify-between px-3 py-2 text-sm font-semibold text-[#0f172a]",children:[e.jsx("span",{children:t("drawer.prefs","Preferenze card")}),e.jsx(_,{size:16,className:`text-[#94a3b8] transition-transform duration-[120ms] ${y?"":"rotate-180"}`})]}),y&&e.jsxs("div",{className:"space-y-2 px-3 pb-3",children:[e.jsxs("label",{className:"flex items-center justify-between text-sm text-[#475569]",children:[e.jsx("span",{children:t("drawer.askDelete","Chiedi conferma eliminazione")}),e.jsx("input",{type:"checkbox",checked:h,onChange:s=>b(s.target.checked),className:"accent-[#0f172a]"})]}),e.jsxs("label",{className:"flex items-center justify-between text-sm text-[#475569]",children:[e.jsx("span",{children:t("drawer.hoverInfo","Mostra dettagli al passaggio")}),e.jsx("input",{type:"checkbox",checked:u,onChange:s=>p(s.target.checked),className:"accent-[#0f172a]"})]}),e.jsx("p",{className:"text-[12px] text-[#94a3b8] sm:text-[13px]",children:"Disattiva se preferisci card minimal; la preferenza resta salvata sul profilo."})]})]})]})]})}),e.jsx(R,{open:!!g,message:t("toast.categoryRemoved","Categoria rimossa"),actionLabel:t("toast.undo","Annulla"),onUndo:()=>{g&&x(g)},onClose:()=>w(null)})]})},Q=({onOpenSettings:c})=>{const o=z(),{locale:i,setLocale:r}=o,f=["IT","EN","JA","RU"],[x,d]=a.useState(!1),t=a.useRef(null);return a.useEffect(()=>{const n=m=>{t.current&&!t.current.contains(m.target)&&d(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("header",{className:"flex items-center justify-between border-b border-[var(--glass-border)] px-6 py-3",children:[e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("div",{className:"flex h-6 items-center gap-2 rounded-full bg-white/80 px-3 text-xs font-semibold leading-none text-[#0f172a] shadow-sm",children:e.jsxs("span",{className:"whitespace-nowrap",children:["Loom ",e.jsx("span",{className:"font-medium text-[#64748b]",children:"Studio"})]})})}),e.jsxs("div",{className:"flex items-center gap-3 text-[#475569]",children:[e.jsxs("div",{className:"relative",ref:t,children:[e.jsx("button",{type:"button",onClick:()=>d(n=>!n),className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-xs font-semibold text-[#0f172a] shadow-sm transition duration-[120ms] hover:-translate-y-[1px]",children:i}),x&&e.jsx("div",{className:"absolute right-0 top-full z-50 mt-1 w-36 rounded-2xl border border-[rgba(0,0,0,0.14)] bg-white p-2 shadow-[0_18px_38px_-22px_rgba(15,23,42,0.5)]",children:f.map(n=>e.jsx("button",{className:`block w-full rounded-xl px-3.5 py-2.5 text-[13px] font-semibold ${n===i?"bg-[#f7f7f8] text-[#0f172a]":"text-[#475569] hover:bg-[#f7f7f8]"}`,onClick:()=>{r(n),d(!1)},children:n},n))})]}),e.jsx(k,{to:"/app",className:"rounded-full bg-white/70 p-2 text-[#0f172a] shadow-sm hover:-translate-y-[1px] transition duration-[120ms]","aria-label":o.t("nav.home","Home"),children:e.jsx(J,{size:16})}),e.jsx(k,{to:"/app/profile",className:"flex h-8 w-8 items-center justify-center rounded-full bg-white text-[#0f172a] shadow-sm hover:-translate-y-[1px] transition duration-[120ms]",children:e.jsx(K,{size:18})}),e.jsx("button",{type:"button",onClick:c,className:"h-8 w-8 rounded-full bg-white/70 text-[#475569] shadow-sm hover:-translate-y-[1px] hover:text-[#0f172a] transition duration-[120ms]",children:e.jsx(X,{size:16,className:"mx-auto"})})]})]})},ne=()=>{const[c,o]=a.useState(!1);return e.jsxs("div",{className:"user-select-none min-h-screen w-full px-4 py-8 sm:px-6 md:px-10",children:[e.jsxs("div",{className:"mx-auto flex min-h-[80vh] max-w-5xl flex-col rounded-[26px] border border-[var(--glass-border)] bg-[var(--glass)]/80 shadow-[0_30px_80px_-60px_rgba(15,23,42,0.55)] ",children:[e.jsx(Q,{onOpenSettings:()=>o(!0)}),e.jsx("main",{className:"flex-1 px-6 pb-8 pt-4",children:e.jsx(q,{})})]}),e.jsx(G,{open:c,onClose:()=>o(!1)})]})};export{ne as AppLayout};
