const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/wardrobeStore-DvZzQvYc.js","assets/firebase-DCzW8K6T.js","assets/vendor-77yDWcJJ.js","assets/router-YYQTkf18.js","assets/AppLayout-BocPAfQP.js","assets/Button-CI2oUu3j.js","assets/Input-Bi6IGvP7.js","assets/useCategorySettings-DCQ8-ADA.js","assets/motion-KXh7TDlr.js","assets/icons-DL2PgYE_.js","assets/HomePage-B0-P0RYR.js","assets/Card-B3nxRyRw.js","assets/fallback_m-BEWCsPdO.js","assets/LoginPage-Clvr5hgI.js","assets/ProfilePage-CyPDkift.js","assets/NotFoundPage-dPkadNTc.js","assets/userPreferencesStore-DOqsqxef.js"])))=>i.map(i=>d[i]);
import{r as d,j as n,_ as B,$ as H}from"./vendor-77yDWcJJ.js";import{g as $,a as P,i as z,b as V,o as W,G as K,s as J,c as Y,d as q,e as Q,f as X}from"./firebase-DCzW8K6T.js";import{u as Z,N as _,R as ee,a as v,B as oe}from"./router-YYQTkf18.js";(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))t(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function t(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();const te="modulepreload",re=function(e){return"/Loom-Studio/"+e},I={},w=function(o,r,t){let a=Promise.resolve();if(r&&r.length>0){let h=function(p){return Promise.all(p.map(c=>Promise.resolve(c).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),g=i?.nonce||i?.getAttribute("nonce");a=h(r.map(p=>{if(p=re(p),p in I)return;I[p]=!0;const c=p.endsWith(".css"),m=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${p}"]${m}`))return;const u=document.createElement("link");if(u.rel=c?"stylesheet":te,c||(u.as="script"),u.crossOrigin="",u.href=p,g&&u.setAttribute("nonce",g),document.head.appendChild(u),c)return new Promise((f,s)=>{u.addEventListener("load",f),u.addEventListener("error",()=>s(new Error(`Unable to preload CSS for ${p}`)))})}))}function l(i){const g=new Event("vite:preloadError",{cancelable:!0});if(g.payload=i,window.dispatchEvent(g),!g.defaultPrevented)throw i}return a.then(i=>{for(const g of i||[])g.status==="rejected"&&l(g.reason);return o().catch(l)})},j={apiKey:"AIzaSyBXUVi-zFef8uTmIJX1-77e2rIKgDGJEOw",authDomain:"loom-f82d6.firebaseapp.com",projectId:"loom-f82d6",databaseURL:"https://loom-f82d6-default-rtdb.europe-west1.firebasedatabase.app",appId:"1:40045053100:web:4cdb90cad94cf86f850b09"},A=Object.values(j).every(Boolean);let E;const k=()=>{if(!A)throw new Error("Firebase non configurato: aggiungi le variabili VITE_FIREBASE_* nel .env.local");return E||(E=P().length?P()[0]:z(j)),E},ae=()=>V(k()),ke=()=>$(k()),T=d.createContext(void 0),ne=e=>({name:e.displayName||"Utente",email:e.email||"ospite@local",picture:e.photoURL||void 0,provider:e.providerData?.[0]?.providerId==="password"?"email":e.isAnonymous?"local":"google",uid:e.uid}),ie=({children:e})=>{const[o,r]=d.useState({user:null,loading:A,error:void 0}),t=A?ae():null;d.useEffect(()=>{if(!t)return;const c=W(t,m=>{if(m){const u=ne(m);r({user:u,loading:!1}),u.provider!=="local"&&u.uid&&w(async()=>{const{loadUserTierFromFirestore:f}=await import("./wardrobeStore-DvZzQvYc.js");return{loadUserTierFromFirestore:f}},__vite__mapDeps([0,1,2,3])).then(({loadUserTierFromFirestore:f})=>f(u.uid)).then(f=>{r(s=>!s.user||s.user.uid!==u.uid?s:{...s,user:{...s.user,tier:f}})}).catch(()=>{})}else r({user:null,loading:!1})});return()=>c()},[t]);const a=d.useCallback(async()=>{if(!t){r({user:null,loading:!1,error:"Configura Firebase per usare Google."});return}r(c=>({...c,loading:!0,error:void 0}));try{const c=new K;await J(t,c),r(m=>({...m,loading:!1}))}catch(c){console.error(c),r({user:null,loading:!1,error:"Errore durante il login Google."})}},[t]),l=d.useCallback(async(c,m)=>{if(!t){r({user:null,loading:!1,error:"Configura Firebase per usare email/password."});return}r(u=>({...u,loading:!0,error:void 0}));try{await Y(t,c,m),r(u=>({...u,loading:!1}))}catch(u){console.error(u),r({user:null,loading:!1,error:"Login email/password non riuscito."})}},[t]),i=d.useCallback(async(c,m)=>{if(!t){r({user:null,loading:!1,error:"Configura Firebase per usare email/password."});return}r(u=>({...u,loading:!0,error:void 0}));try{await q(t,c,m),r(u=>({...u,loading:!1}))}catch(u){console.error(u),r({user:null,loading:!1,error:"Registrazione non riuscita."})}},[t]),g=d.useCallback(async()=>{if(!t){r({user:{name:"Ospite",email:"guest@example.com",provider:"local"},loading:!1});return}r(c=>({...c,loading:!0,error:void 0}));try{await Q(t)}catch(c){console.error(c),r({user:null,loading:!1,error:"Login ospite non riuscito."})}},[t]),h=d.useCallback(async()=>{if(!t){r({user:null,loading:!1});return}await X(t),r({user:null,loading:!1})},[t]),p=d.useMemo(()=>({...o,signInWithGoogle:a,signInAsGuest:g,signInWithEmail:l,registerWithEmail:i,signOut:h}),[g,l,i,a,h,o]);return n.jsx(T.Provider,{value:p,children:e})},se=()=>T,N=()=>{const e=d.useContext(se());if(!e)throw new Error("useAuth must be used within AuthProvider");return e},le=(e,o,r)=>{const t=o??e;return r?Object.keys(r).reduce((a,l)=>a.replace(`{${l}}`,String(r[l])),t):t},O=d.createContext({locale:"IT",setLocale:()=>{},t:le}),G=()=>d.useContext(O),b=()=>{const{t:e}=G();return n.jsx("div",{className:"flex min-h-screen items-center justify-center bg-transparent",children:n.jsxs("div",{className:"flex items-center gap-3 rounded-[20px] border border-[rgba(0,0,0,0.06)] bg-white/80 px-4 py-3 shadow-[0_20px_60px_-40px_rgba(15,23,42,0.45)] backdrop-blur-sm",children:[n.jsx("span",{className:"h-3 w-3 animate-spin rounded-full border-2 border-[#0f172a] border-t-transparent","aria-hidden":!0}),n.jsx("div",{className:"text-sm font-medium text-[#0f172a]",children:e("splash.loading")})]})})},ce=({children:e})=>{const{user:o,loading:r}=N(),t=Z();return r?n.jsx(b,{}):o?n.jsx(n.Fragment,{children:e}):n.jsx(_,{to:"/login",state:{from:t},replace:!0})},me=d.lazy(()=>w(()=>import("./AppLayout-BocPAfQP.js"),__vite__mapDeps([4,2,5,6,7,8,9,3,1])).then(e=>({default:e.AppLayout}))),de=d.lazy(()=>w(()=>import("./HomePage-B0-P0RYR.js"),__vite__mapDeps([10,2,5,11,9,8,6,7,12,0,1,3])).then(e=>({default:e.HomePage}))),ue=d.lazy(()=>w(()=>import("./LoginPage-Clvr5hgI.js"),__vite__mapDeps([13,2,5,11,6,3,9,1])).then(e=>({default:e.LoginPage}))),ge=d.lazy(()=>w(()=>import("./ProfilePage-CyPDkift.js"),__vite__mapDeps([14,2,11,5,9,12,8,1,3])).then(e=>({default:e.ProfilePage}))),pe=d.lazy(()=>w(()=>import("./NotFoundPage-dPkadNTc.js"),__vite__mapDeps([15,2,5,3])).then(e=>({default:e.NotFoundPage}))),fe=()=>n.jsxs(ee,{children:[n.jsx(v,{path:"/login",element:n.jsx(d.Suspense,{fallback:n.jsx(b,{}),children:n.jsx(ue,{})})}),n.jsxs(v,{path:"/app",element:n.jsx(ce,{children:n.jsx(d.Suspense,{fallback:n.jsx(b,{}),children:n.jsx(me,{})})}),children:[n.jsx(v,{index:!0,element:n.jsx(d.Suspense,{fallback:n.jsx(b,{}),children:n.jsx(de,{})})}),n.jsx(v,{path:"profile",element:n.jsx(d.Suspense,{fallback:n.jsx(b,{}),children:n.jsx(ge,{})})})]}),n.jsx(v,{path:"/",element:n.jsx(_,{to:"/app",replace:!0})}),n.jsx(v,{path:"*",element:n.jsx(d.Suspense,{fallback:n.jsx(b,{}),children:n.jsx(pe,{})})})]}),he=()=>n.jsx(fe,{}),L="ws-lang",x={IT:{"login.title":"Accedi","login.subtitle":"Login Google ufficiale o accesso ospite.","login.email":"Email","login.password":"Password","login.signin":"Accedi con email","login.signup":"Crea account","login.switchToLogin":"Hai già un account? Accedi","login.switchToSignup":"Non hai un account? Registrati","login.google":"Continua con Google","login.guest":"Entra come ospite","splash.loading":"Carico Loom…","home.addItem":"Aggiungi un capo","home.emptyHint":"Aggiungi i capi che possiedi. Loom ti aiuta a ricordarli.","home.search":"Cerca capi, tag, colori","home.filter.category":"Capo","home.filter.color":"Colore","home.filter.season":"Stagione","home.new.title":"Nuovo capo","home.new.subtitle":"Carica la foto (drag & drop o upload), poi completa i dettagli.","home.new.cancel":"Annulla","home.new.save":"Salva capo","home.upload.drag":"Trascina qui la foto del capo","home.upload.click":"Oppure clicca per scegliere un file","home.upload.removeBg":"Rimuovi sfondo (beta)","home.fields.category":"Categoria","home.fields.color":"Colore","home.fields.season":"Stagione (Primavera/Estate/Autunno/Inverno)","home.fields.note":"Note","home.tags.label":"Tag (facoltativi)","home.tags.add":"Aggiungi tag","home.showMore":"Mostra altri {count}","dialog.delete.title":"Eliminare il capo?","dialog.delete.desc":"Questa operazione rimuove la card dal tuo guardaroba.","dialog.delete.noAsk":"Non chiedere più","profile.title":"Profilo","profile.account":"Account","profile.stat.total":"Capi totali","profile.stat.cat":"Categoria più frequente","profile.stat.tag":"Tag più usato","profile.stat.season":"Stagione top","profile.stat.redundancy":"Colore prevalente: {count} capi {color} ({percent}%).","profile.stat.empty":"Non disponibile","profile.logout":"Logout","profile.gender.label":"Sesso","profile.gender.female":"Donna","profile.gender.male":"Uomo","profile.avatarAlt":"Avatar profilo","profile.avatar.change":"Cambia foto profilo","drawer.categories":"Categorie personalizzate","drawer.profile":"Profilo","drawer.addCategory":"Aggiungi categoria","drawer.newCategory":"Nuova categoria (es. Maglietta)","drawer.prefs":"Preferenze card","drawer.askDelete":"Chiedi conferma eliminazione","drawer.hoverInfo":"Mostra dettagli al passaggio","toast.itemRemoved":"Capo rimosso","toast.categoryRemoved":"Categoria rimossa","toast.undo":"Annulla","support.title":"Sostieni Loom","support.body.line1":"Loom cresce piano: completi, suggerimenti e versione telefono arriveranno con il tempo.","support.body.line2":"Se ti è utile, puoi offrirmi un caffè per sostenere lo sviluppo.","support.cta":"Offrimi un caffè ☕","support.external":"Apri un link esterno","support.missing":"Link non configurato","support.what":"Cosa finanzia?","support.modal.title":"Cosa finanzia?","support.modal.bullet1":"Completi / outfit (salvataggio e ricerca)","support.modal.bullet2":"Suggerimenti intelligenti (non invadenti)","support.modal.bullet3":"Versione mobile (UI e performance)","common.close":"Chiudi","sample.item.name":"Maglietta","sample.item.category":"Maglietta","sample.item.color":"Nero","sample.item.note":"Esempio di capo con tag e note.","sample.tag.casual":"Casual","sample.tag.office":"Ufficio","nav.home":"Home","common.or":"oppure","common.all":"Tutti","common.add":"Aggiungi","common.remove":"Rimuovi","garment.noNote":"Nessuna nota","garment.menu":"Menu","garment.remove":"Rimuovi","garment.edit":"Modifica","garment.replacePhoto":"Sostituisci foto","garment.tags":"Tag","term.season.spring":"Primavera","term.season.summer":"Estate","term.season.autumn":"Autunno","term.season.winter":"Inverno","term.category.tshirt":"Maglietta","term.category.shirt":"Camicia","term.category.pants":"Pantaloni","term.category.shoes":"Scarpe","term.category.jacket":"Giacca","term.category.coat":"Cappotto","term.category.hoodie":"Felpa","term.category.dress":"Vestito","term.category.skirt":"Gonna","term.category.accessories":"Accessori","term.color.black":"Nero","term.color.white":"Bianco","term.color.gray":"Grigio","term.color.blue":"Blu","term.color.red":"Rosso","term.color.green":"Verde","term.color.yellow":"Giallo","term.color.pink":"Rosa","term.color.purple":"Viola","term.color.brown":"Marrone","term.color.beige":"Beige","term.color.orange":"Arancione"},EN:{"login.title":"Sign in","login.subtitle":"Google sign-in or guest access.","login.email":"Email","login.password":"Password","login.signin":"Sign in with email","login.signup":"Create account","login.switchToLogin":"Already have an account? Sign in","login.switchToSignup":"Don't have an account? Sign up","login.google":"Continue with Google","login.guest":"Enter as guest","splash.loading":"Loading Loom…","home.addItem":"Add a garment","home.emptyHint":"Add the pieces you own. Loom helps you remember them.","home.search":"Search items, tags, colors","home.filter.category":"Item","home.filter.color":"Color","home.filter.season":"Season","home.new.title":"New garment","home.new.subtitle":"Upload a photo, then complete the details.","home.new.cancel":"Cancel","home.new.save":"Save garment","home.upload.drag":"Drag your garment photo here","home.upload.click":"Or click to choose a file","home.upload.removeBg":"Remove background (beta)","home.fields.category":"Category","home.fields.color":"Color","home.fields.season":"Season (Spring/Summer/Fall/Winter)","home.fields.note":"Notes","home.tags.label":"Tags (optional)","home.tags.add":"Add tag","home.showMore":"Show {count} more","dialog.delete.title":"Remove this garment?","dialog.delete.desc":"This will remove the card from your wardrobe.","dialog.delete.noAsk":"Don't ask again","profile.title":"Profile","profile.account":"Account","profile.stat.total":"Total garments","profile.stat.cat":"Most frequent category","profile.stat.tag":"Most used tag","profile.stat.season":"Top season","profile.stat.redundancy":"Prevailing color: {count} {color} items ({percent}%).","profile.stat.empty":"Not available","profile.logout":"Sign out","profile.gender.label":"Gender","profile.gender.female":"Female","profile.gender.male":"Male","profile.avatarAlt":"Profile avatar","profile.avatar.change":"Change profile photo","drawer.categories":"Custom categories","drawer.profile":"Profile","drawer.addCategory":"Add category","drawer.newCategory":"New category (e.g. T-shirt)","drawer.prefs":"Card preferences","drawer.askDelete":"Ask delete confirmation","drawer.hoverInfo":"Show details on hover","toast.itemRemoved":"Item removed","toast.categoryRemoved":"Category removed","toast.undo":"Undo","support.title":"Support Loom","support.body.line1":"Loom grows slowly: outfits, suggestions and mobile are coming over time.","support.body.line2":"If it helps you, you can buy me a coffee to support development.","support.cta":"Buy me a coffee ☕","support.external":"Open an external link","support.missing":"Link not configured","support.what":"What does it fund?","support.modal.title":"What does it fund?","support.modal.bullet1":"Outfits (save & search)","support.modal.bullet2":"Smart suggestions (non-intrusive)","support.modal.bullet3":"Mobile version (UI and performance)","common.close":"Close","sample.item.name":"T-Shirt","sample.item.category":"T-Shirt","sample.item.color":"Black","sample.item.note":"Sample garment with tags and notes.","sample.tag.casual":"Casual","sample.tag.office":"Office","nav.home":"Home","common.or":"or","common.all":"All","common.add":"Add","common.remove":"Remove","garment.noNote":"No notes","garment.menu":"Menu","garment.remove":"Remove","garment.edit":"Edit","garment.replacePhoto":"Replace photo","garment.tags":"Tags","term.season.spring":"Spring","term.season.summer":"Summer","term.season.autumn":"Autumn","term.season.winter":"Winter","term.category.tshirt":"T-shirt","term.category.shirt":"Shirt","term.category.pants":"Pants","term.category.shoes":"Shoes","term.category.jacket":"Jacket","term.category.coat":"Coat","term.category.hoodie":"Hoodie","term.category.dress":"Dress","term.category.skirt":"Skirt","term.category.accessories":"Accessories","term.color.black":"Black","term.color.white":"White","term.color.gray":"Gray","term.color.blue":"Blue","term.color.red":"Red","term.color.green":"Green","term.color.yellow":"Yellow","term.color.pink":"Pink","term.color.purple":"Purple","term.color.brown":"Brown","term.color.beige":"Beige","term.color.orange":"Orange"},JA:{"login.title":"ログイン","login.subtitle":"Google でログイン、またはゲストとして入る。","login.email":"メール","login.password":"パスワード","login.signin":"メールでログイン","login.signup":"アカウント作成","login.switchToLogin":"アカウントがありますか？ ログイン","login.switchToSignup":"アカウントがありませんか？ 作成","login.google":"Google で続行","login.guest":"ゲストで入る","splash.loading":"Loom を読み込み中…","home.addItem":"アイテムを追加","home.emptyHint":"持っている服を追加しましょう。Loom が覚えておきます。","home.search":"アイテム・タグ・カラーを検索","home.filter.category":"アイテム","home.filter.color":"カラー","home.filter.season":"シーズン","home.new.title":"新しいアイテム","home.new.subtitle":"写真をアップロードして詳細を入力してください。","home.new.cancel":"キャンセル","home.new.save":"保存","home.upload.drag":"ここに写真をドラッグ","home.upload.click":"またはクリックしてファイルを選択","home.upload.removeBg":"背景を削除（ベータ）","home.fields.category":"カテゴリ","home.fields.color":"色","home.fields.season":"シーズン（春/夏/秋/冬）","home.fields.note":"ノート","home.tags.label":"タグ（任意）","home.tags.add":"タグを追加","home.showMore":"さらに{count}件表示","dialog.delete.title":"アイテムを削除しますか？","dialog.delete.desc":"ワードローブからこのカードを削除します。","dialog.delete.noAsk":"今後確認しない","profile.title":"プロフィール","profile.account":"アカウント","profile.stat.total":"アイテム総数","profile.stat.cat":"最頻カテゴリ","profile.stat.tag":"最頻タグ","profile.stat.season":"最多シーズン","profile.stat.redundancy":"優勢カラー: {color} が {count} 点（{percent}%）","profile.stat.empty":"データなし","profile.logout":"ログアウト","profile.gender.label":"性別","profile.gender.female":"女性","profile.gender.male":"男性","profile.avatarAlt":"プロフィール画像","profile.avatar.change":"プロフィール画像を変更","drawer.categories":"カスタムカテゴリ","drawer.profile":"プロフィール","drawer.addCategory":"カテゴリを追加","drawer.newCategory":"新しいカテゴリ (例: Tシャツ)","drawer.prefs":"カード設定","drawer.askDelete":"削除前に確認","drawer.hoverInfo":"ホバーで詳細表示","toast.itemRemoved":"アイテムを削除しました","toast.categoryRemoved":"カテゴリを削除しました","toast.undo":"元に戻す","support.title":"Loom を支援","support.body.line1":"Loom はゆっくり成長します。コーデ、提案、モバイル版は時間をかけて。","support.body.line2":"役に立つなら、開発支援としてコーヒーをどうぞ。","support.cta":"コーヒーをおごる ☕","support.external":"外部リンクを開く","support.missing":"リンク未設定","support.what":"何に使われますか？","support.modal.title":"何に使われますか？","support.modal.bullet1":"コーデ機能（保存と検索）","support.modal.bullet2":"スマート提案（控えめ）","support.modal.bullet3":"モバイル版（UI とパフォーマンス）","common.close":"閉じる","sample.item.name":"Tシャツ","sample.item.category":"Tシャツ","sample.item.color":"黒","sample.item.note":"タグとメモ付きのサンプル。","sample.tag.casual":"カジュアル","sample.tag.office":"オフィス","nav.home":"ホーム","common.or":"または","common.all":"すべて","common.add":"追加","common.remove":"削除","garment.noNote":"メモなし","garment.menu":"メニュー","garment.remove":"削除","garment.edit":"編集","garment.replacePhoto":"写真を変更","garment.tags":"タグ","term.season.spring":"春","term.season.summer":"夏","term.season.autumn":"秋","term.season.winter":"冬","term.category.tshirt":"Tシャツ","term.category.shirt":"シャツ","term.category.pants":"パンツ","term.category.shoes":"靴","term.category.jacket":"ジャケット","term.category.coat":"コート","term.category.hoodie":"パーカー","term.category.dress":"ワンピース","term.category.skirt":"スカート","term.category.accessories":"アクセサリー","term.color.black":"黒","term.color.white":"白","term.color.gray":"灰色","term.color.blue":"青","term.color.red":"赤","term.color.green":"緑","term.color.yellow":"黄","term.color.pink":"ピンク","term.color.purple":"紫","term.color.brown":"茶色","term.color.beige":"ベージュ","term.color.orange":"オレンジ"},RU:{"login.title":"Вход","login.subtitle":"Вход через Google или как гость.","login.email":"Email","login.password":"Пароль","login.signin":"Войти по email","login.signup":"Создать аккаунт","login.switchToLogin":"Уже есть аккаунт? Войти","login.switchToSignup":"Нет аккаунта? Зарегистрироваться","login.google":"Продолжить с Google","login.guest":"Войти как гость","splash.loading":"Загружаю Loom…","home.addItem":"Добавить вещь","home.emptyHint":"Добавьте свои вещи. Loom поможет помнить о них.","home.search":"Искать вещи, теги, цвета","home.filter.category":"Вещь","home.filter.color":"Цвет","home.filter.season":"Сезон","home.new.title":"Новая вещь","home.new.subtitle":"Загрузите фото, затем заполните детали.","home.new.cancel":"Отмена","home.new.save":"Сохранить","home.upload.drag":"Перетащите фото вещи сюда","home.upload.click":"Или нажмите, чтобы выбрать файл","home.upload.removeBg":"Удалить фон (бета)","home.fields.category":"Категория","home.fields.color":"Цвет","home.fields.season":"Сезон (весна/лето/осень/зима)","home.fields.note":"Заметки","home.tags.label":"Теги (необязательно)","home.tags.add":"Добавить тег","home.showMore":"Показать ещё {count}","dialog.delete.title":"Удалить эту вещь?","dialog.delete.desc":"Это уберёт карточку из гардероба.","dialog.delete.noAsk":"Больше не спрашивать","profile.title":"Профиль","profile.account":"Аккаунт","profile.stat.total":"Всего вещей","profile.stat.cat":"Частая категория","profile.stat.tag":"Частый тег","profile.stat.season":"Главный сезон","profile.stat.redundancy":"Преобладающий цвет: {color} — {count} шт. ({percent}%).","profile.stat.empty":"Нет данных","profile.logout":"Выйти","profile.gender.label":"Пол","profile.gender.female":"Женский","profile.gender.male":"Мужской","profile.avatarAlt":"Аватар профиля","profile.avatar.change":"Сменить фото профиля","drawer.categories":"Свои категории","drawer.profile":"Профиль","drawer.addCategory":"Добавить категорию","drawer.newCategory":"Новая категория (например, футболка)","drawer.prefs":"Настройки карточек","drawer.askDelete":"Спрашивать перед удалением","drawer.hoverInfo":"Показывать детали при наведении","toast.itemRemoved":"Вещь удалена","toast.categoryRemoved":"Категория удалена","toast.undo":"Отменить","support.title":"Поддержать Loom","support.body.line1":"Loom растёт постепенно: образы, подсказки и мобильная версия появятся со временем.","support.body.line2":"Если полезно, можете угостить кофе в поддержку разработки.","support.cta":"Угостить кофе ☕","support.external":"Открыть внешнюю ссылку","support.missing":"Ссылка не настроена","support.what":"Что финансируется?","support.modal.title":"Что финансируется?","support.modal.bullet1":"Образы (сохранение и поиск)","support.modal.bullet2":"Умные подсказки (ненавязчиво)","support.modal.bullet3":"Мобильная версия (UI и производительность)","common.close":"Закрыть","sample.item.name":"Футболка","sample.item.category":"Футболка","sample.item.color":"Чёрный","sample.item.note":"Пример вещи с тегами и заметками.","sample.tag.casual":"Повседневное","sample.tag.office":"Офис","nav.home":"Главная","common.or":"или","common.all":"Все","common.add":"Добавить","common.remove":"Удалить","garment.noNote":"Нет заметок","garment.menu":"Меню","garment.remove":"Удалить","garment.edit":"Изменить","garment.replacePhoto":"Заменить фото","garment.tags":"Теги","term.season.spring":"Весна","term.season.summer":"Лето","term.season.autumn":"Осень","term.season.winter":"Зима","term.category.tshirt":"Футболка","term.category.shirt":"Рубашка","term.category.pants":"Брюки","term.category.shoes":"Обувь","term.category.jacket":"Куртка","term.category.coat":"Пальто","term.category.hoodie":"Худи","term.category.dress":"Платье","term.category.skirt":"Юбка","term.category.accessories":"Аксессуары","term.color.black":"Чёрный","term.color.white":"Белый","term.color.gray":"Серый","term.color.blue":"Синий","term.color.red":"Красный","term.color.green":"Зелёный","term.color.yellow":"Жёлтый","term.color.pink":"Розовый","term.color.purple":"Фиолетовый","term.color.brown":"Коричневый","term.color.beige":"Бежевый","term.color.orange":"Оранжевый"}},we=({children:e})=>{const[o,r]=d.useState(()=>{if(typeof window>"u")return"IT";const i=localStorage.getItem(L);return i==="EN"||i==="JA"||i==="RU"||i==="IT"?i:"IT"}),t=d.useCallback(i=>{r(i),typeof window<"u"&&(localStorage.setItem(L,i),window.dispatchEvent(new CustomEvent("ws-lang-updated",{detail:{locale:i}})))},[]),a=d.useCallback((i,g,h)=>{const p=x[o]?.[i]??x.IT[i]??g??i;return h?Object.keys(h).reduce((c,m)=>c.replace(`{${m}}`,String(h[m])),p):p},[o]),l=d.useMemo(()=>({locale:o,setLocale:t,t:a}),[o,t,a]);return n.jsx(O.Provider,{value:l,children:e})},U=e=>`ws-items-${e}`,D=e=>`ws-confirm-delete-${e}`,M=e=>`ws-hover-info-${e}`,F=e=>`ws-profile-gender-${e}`,C=e=>`ws-profile-avatar-${e}`,R=e=>typeof e=="object"&&e!==null,Te=e=>{if(typeof window>"u")return[];try{const o=localStorage.getItem(U(e));if(!o)return[];const r=JSON.parse(o);return Array.isArray(r)?r.map(t=>{if(!R(t))return null;const{imageUrl:a,description:l,...i}=t;let g=i;return typeof a=="string"&&!R(g.image)&&(g={...g,image:{url:a,provider:"legacy"}}),typeof l=="string"&&typeof g.note!="string"&&(g={...g,note:l}),g}).filter(t=>!!t):[]}catch{return[]}},Ne=(e,o)=>{if(!(typeof window>"u"))try{localStorage.setItem(U(e),JSON.stringify(o)),window.dispatchEvent(new CustomEvent("ws-items-updated",{detail:{profile:e,items:o}}))}catch{}},ye=e=>typeof window>"u"?!0:localStorage.getItem(D(e))!=="false",ve=(e,o)=>{typeof window>"u"||(localStorage.setItem(D(e),String(o)),window.dispatchEvent(new CustomEvent("ws-preferences-updated",{detail:{profile:e,confirmDelete:o}})))},be=e=>typeof window>"u"?!0:localStorage.getItem(M(e))!=="false",Se=(e,o)=>{typeof window>"u"||(localStorage.setItem(M(e),String(o)),window.dispatchEvent(new CustomEvent("ws-preferences-updated",{detail:{profile:e,showHoverInfo:o}})))},Ee=e=>typeof window>"u"?"female":localStorage.getItem(F(e))==="male"?"male":"female",Ae=(e,o)=>{typeof window>"u"||(localStorage.setItem(F(e),o),window.dispatchEvent(new CustomEvent("ws-profile-updated",{detail:{profile:e,gender:o}})))},Oe=e=>{if(typeof window>"u")return null;try{return localStorage.getItem(C(e))||null}catch{return null}},Ge=(e,o)=>{if(!(typeof window>"u"))try{o?localStorage.setItem(C(e),o):localStorage.removeItem(C(e)),window.dispatchEvent(new CustomEvent("ws-profile-updated",{detail:{profile:e,avatar:o}}))}catch{}},S=["Maglietta","Felpa","Pantaloni","Giacca","Cappotto"],Ce=e=>{if(typeof window>"u")return S;try{const o=localStorage.getItem(`ws-categories-${e}`);if(!o)return S;const r=JSON.parse(o);if(!Array.isArray(r))return S;const t=r.filter(a=>typeof a=="string");return t.length?t:S}catch{return S}},Pe=(e,o)=>{if(!(typeof window>"u"))try{localStorage.setItem(`ws-categories-${e}`,JSON.stringify(o)),window.dispatchEvent(new CustomEvent("ws-categories-updated",{detail:{profile:e,categories:o}}))}catch{}},Ie=()=>{const{user:e}=N(),{locale:o,setLocale:r}=G(),t=d.useMemo(()=>e?.email||e?.uid||"guest",[e?.email,e?.uid]),a=e?.provider!=="local"&&e?.uid||null,l=!!a,i=d.useRef(!1),g=d.useRef(null);return d.useEffect(()=>{if(!l||!a)return;let h=!1;return i.current=!0,(async()=>{try{const c=await w(()=>import("./userPreferencesStore-DOqsqxef.js"),__vite__mapDeps([16,1,2,3])),m=await c.loadUserPreferences(a);if(h)return;if(m){m.locale&&m.locale!==o&&r(m.locale),typeof m.confirmDelete=="boolean"&&ve(t,m.confirmDelete),typeof m.showHoverInfo=="boolean"&&Se(t,m.showHoverInfo),Array.isArray(m.categories)&&Pe(t,m.categories),m.profileGender&&Ae(t,m.profileGender);return}if(!c.hasAnyLocalPreferences(t)){await c.saveUserPreferences(a,{locale:o});return}await c.saveUserPreferences(a,{locale:o,confirmDelete:ye(t),showHoverInfo:be(t),categories:Ce(t),profileGender:Ee(t)})}catch(c){console.warn("[prefs] hydrate failed, keeping localStorage only",c)}finally{i.current=!1}})(),()=>{h=!0,i.current=!1}},[l,o,t,r,a]),d.useEffect(()=>{if(!l||!a)return;const h=f=>{i.current||(g.current&&window.clearTimeout(g.current),g.current=window.setTimeout(async()=>{try{await(await w(()=>import("./userPreferencesStore-DOqsqxef.js"),__vite__mapDeps([16,1,2,3]))).saveUserPreferences(a,f)}catch(s){console.warn("[prefs] save failed, keeping localStorage only",s)}},600))},p=f=>{const s=f.detail;if(!s||s.profile!==t)return;const y={};typeof s.confirmDelete=="boolean"&&(y.confirmDelete=s.confirmDelete),typeof s.showHoverInfo=="boolean"&&(y.showHoverInfo=s.showHoverInfo),Object.keys(y).length&&h(y)},c=f=>{const s=f.detail;!s||s.profile!==t||Array.isArray(s.categories)&&h({categories:s.categories.filter(y=>typeof y=="string")})},m=f=>{const s=f.detail;!s||s.profile!==t||(s.gender==="female"||s.gender==="male")&&h({profileGender:s.gender})},u=f=>{const s=f.detail;!s||!s.locale||(s.locale==="IT"||s.locale==="EN"||s.locale==="JA"||s.locale==="RU")&&h({locale:s.locale})};return window.addEventListener("ws-preferences-updated",p),window.addEventListener("ws-categories-updated",c),window.addEventListener("ws-profile-updated",m),window.addEventListener("ws-lang-updated",u),()=>{window.removeEventListener("ws-preferences-updated",p),window.removeEventListener("ws-categories-updated",c),window.removeEventListener("ws-profile-updated",m),window.removeEventListener("ws-lang-updated",u),g.current&&window.clearTimeout(g.current)}},[l,t,a]),null},Le=({children:e})=>{const r="/Loom-Studio/".replace(/\/$/,"");return n.jsx(oe,{basename:r,children:n.jsx(we,{children:n.jsxs(ie,{children:[n.jsx(Ie,{}),e]})})})},xe=()=>{if(typeof window>"u")return;const e=["key","apiKey","api_key","access_token","id_token"],o=new URL(window.location.href);let r=!1;if(e.forEach(t=>{o.searchParams.has(t)&&(o.searchParams.delete(t),r=!0)}),o.hash&&o.hash.includes("=")){const[t,a=""]=o.hash.split("?");if(a){const l=new URLSearchParams(a);e.forEach(i=>{l.has(i)&&(l.delete(i),r=!0)}),o.hash=l.toString()?`${t}?${l.toString()}`:t}}r&&window.history.replaceState({},document.title,o.toString())};xe();B.createRoot(document.getElementById("root")).render(n.jsx(H.StrictMode,{children:n.jsx(Le,{children:n.jsx(he,{})})}));export{G as a,ye as b,ve as c,Ee as d,Te as e,Ne as f,Oe as g,Ae as h,Ge as i,ke as j,be as l,Se as s,N as u};
