const p=(t,e,o)=>new Promise(a=>t.toBlob(n=>a(URL.createObjectURL(n)),e,o)),u=async(t,{maxSize:e=1280,quality:o=.76}={})=>{const a=await createImageBitmap(t),n=Math.min(e/a.width,e/a.height,1),r=Math.round(a.width*n),s=Math.round(a.height*n),c=document.createElement("canvas");c.width=r,c.height=s;const i=c.getContext("2d");if(!i)throw new Error("Canvas context not available");i.drawImage(a,0,0,r,s);const l=await new Promise(m=>c.toBlob(g=>m(g||t),"image/webp",o)),d=await p(c,"image/webp",o);return{blob:l,dataUrl:d}},w=async t=>t,b=async(t,e)=>{const o=new FormData;o.append("image",t);const a=await fetch(`https://api.imgbb.com/1/upload?key=${e}`,{method:"POST",body:o});if(!a.ok)throw new Error("Upload imgbb fallito");const r=(await a.json())?.data;return{url:r?.url,provider:"imgbb",providerId:r?.id,deleteUrl:r?.delete_url,uploadedAt:new Date().toISOString()}},h=async(t,e)=>{let o=t;e?.removeBackground&&(o=await w(t));const a="e58ef7804f54eead7b9269e7677387cf";try{return await b(o,a)}catch(r){console.warn("Upload imgbb fallito, uso provider local",r)}return{url:URL.createObjectURL(o),provider:"local",uploadedAt:new Date().toISOString()}},f="/Loom-Studio/assets/fallback_f-axWJyrnx.png",U="/Loom-Studio/assets/fallback_m-CaT4aWd5.png";export{f as a,u as c,U as f,w as r,h as u};
